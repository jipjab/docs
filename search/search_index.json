{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Monitor, manage, and secure your IT infrastructure with enterprise-grade solutions built from the ground up.","text":"<p>This is more for my memory than anything else, but maybe it'll help someone else.</p>"},{"location":"#topics-projects","title":"Topics &amp; Projects:","text":"<ul> <li><code>Tips &amp; Tricks</code> - All tricks and usefull commands I use daily.</li> <li><code>Security Settings</code> - Some of the best security practices.</li> <li><code>Personal projects</code> - Ideas and ongoing projects</li> <li><code>Microsoft Azure</code></li> <li><code>Microsoft EndPoint (Intune)</code> - Autopilote, Patch management,..</li> <li><code>Microsoft Defender</code></li> <li><code>Cybereason</code> - NGAV, EDR, MDR &amp; XDR</li> <li><code>Kaspersky</code></li> </ul>"},{"location":"Adobe/","title":"Adobe Microsoft Purview Information Protection","text":""},{"location":"Adobe/#steps-to-enable-document-message-bar","title":"Steps to enable document message bar","text":"<p>Regedit</p> <p>Pour Adobe Acrobat  Computer\\HKEY_CURRENT_USER\\SOFTWARE\\Adobe\\Adobe Acrobat\\DC\\MicrosoftAIP And set the value: bShowDMB value to 1</p> <p>Pour Adobe Reader Computer\\HKEY_CURRENT_USER\\SOFTWARE\\Adobe\\Acrobat Reader\\DC\\MicrosoftAIP And set the value: bShowDMB value to 1</p> <p>Sources: Adobe Microsoft AIP</p>"},{"location":"Apple/","title":"Apple","text":"<p>Local account ```sh title=\"Create a mac os local account\"</p>"},{"location":"Apple/#binzsh","title":"!/bin/zsh","text":""},{"location":"Apple/#username-and-password-to-create","title":"Username and Password to create","text":"<p>username=user password=\"pass</p>"},{"location":"Apple/#create-user-with-add-to-admins","title":"Create User with add to admins","text":"<p>dscl . -create /Users/\\(username dscl . -create /Users/\\)username UserShell /bin/zsh dscl . -create /Users/\\(username RealName \\(username dscl . -create /Users/\\)username UniqueID \"901\" dscl . -create /Users/\\)username PrimaryGroupID 20 dscl . -create /Users/\\(username NFSHomeDirectory /Users/\\)username dscl . -passwd /Users/$username $password dscl . -append /Groups/admin GroupMembership $username</p> <p>``</p>"},{"location":"Azure/","title":"Creation d'un tenant microsoft","text":""},{"location":"Azure/#azure-basics","title":"Azure Basics","text":""},{"location":"Azure/#pre-requis","title":"Pre-requis","text":""},{"location":"Azure/#ensure-security-defaults-is-disabled-on-azure-active-directory","title":"Ensure Security Defaults is disabled on Azure Active Directory","text":"<p>Par d\u00e9faut, Microsoft active les param\u00e8tres de s\u00e9curit\u00e9 par d\u00e9faut. L'objectif est de s'assurer que toutes les organisations disposent d'un niveau de s\u00e9curit\u00e9 de base. Cependant, l'utilisation des param\u00e8tres de s\u00e9curit\u00e9 par d\u00e9faut emp\u00eache l\u2019application de param\u00e8tres personnalis\u00e9s qui sont recommand\u00e9s d\u2019\u00eatre d\u00e9finis dans ce benchmark.</p> <p>Portal Azure AD &gt; Overview &gt; Properties</p> <p></p> <p>Microsoft Entra ID &gt; Identity &gt; Overview &gt; Properties</p> <p></p>"},{"location":"Azure/#ensure-multifactor-authentication-is-enabled-for-all-users-in-administrative-roles","title":"Ensure multifactor authentication is enabled for all users in administrative roles","text":"<p>Tous les comptes utilisateurs (administrateurs et utilisateurs standard) doivent avoir le MFA (Multi-Factor Authentication) activ\u00e9. L\u2019activation du MFA est primordiale pour assurer la s\u00e9curit\u00e9 de vos utilisateurs et donn\u00e9es.</p> <p>Lien Dashboard M365 : Conditional Access - Microsoft Azure</p>"},{"location":"Azure/#ensure-sign-in-frequency-is-enabled-and-browser-sessions-are-not-persistent-for-administrative-users","title":"Ensure Sign-in frequency is enabled and browser sessions are not persistent for Administrative users.","text":"<p>Le fait de forcer un d\u00e9lai d'expiration pour les sessions administrateur permet de s'assurer que les sessions de navigateur ne sont pas persistantes et permet de pr\u00e9venir les attaques de type \"drive-by\" dans les navigateurs web, ce qui emp\u00eache \u00e9galement la cr\u00e9ation et l'enregistrement de cookies de session.</p> <p>Lien Dashboard M365 : https://aad.portal.azure.com/</p>"},{"location":"Azure/#ensure-multifactor-authentication-is-enabled-for-all-users-in-all-roles","title":"Ensure multifactor authentication is enabled for all users in all roles","text":"<p>Tous les comptes utilisateurs (administrateurs et utilisateurs standards) doivent avoir le MFA (Multi-Factor Authentication) activ\u00e9. L\u2019activation du MFA est primordiale pour assurer la s\u00e9curit\u00e9 de vos utilisateurs et donn\u00e9es.</p> <p>Lien Dashboard M365 : Conditional Access - Microsoft Azure</p>"},{"location":"Azure/#ensure-microsoft-authenticator-is-configured-to-protect-against-mfa-fatigue","title":"Ensure Microsoft Authenticator is configured to protect against MFA fatigue","text":"<p>Les comptes utilisateurs doivent \u00eatre prot\u00e9g\u00e9s contre les attaques de type \u00ab MFA bombing \u00bb. Des pr\u00e9cisions sur la localisation g\u00e9ographique de la requ\u00eate, l\u2019application ainsi que la n\u00e9cessit\u00e9 d\u2019entrer un nombre en plus du push MFA permettent \u00e0 l\u2019utilisateur de mieux v\u00e9rifier une requ\u00eate MFA.</p> <p></p>"},{"location":"Azure/#ensure-phishing-resistant-mfa-strength-is-required-for-administrators","title":"Ensure 'Phishing-resistant MFA strength' is required for Administrators","text":"<p>L\u2019 \u00ab authentication strength \u00bb est un r\u00e9glage du Conditional Access de Microsoft permettant de d\u00e9finir les m\u00e9thodes d\u2019authentification n\u00e9cessaires \u00e0 l\u2019acc\u00e8s d\u2019une ressource. Ce r\u00e9glage doit \u00eatre param\u00e9tr\u00e9 pour tous les comptes administrateurs, selon l\u2019une de ces 3 m\u00e9thodes :</p> <ul> <li>FIDO2 Security Key</li> <li>Windows Hello for Business</li> <li>Certificate-based authentication (Multi-Factor)</li> </ul>"},{"location":"Azure/#ensure-that-between-two-and-four-global-admins-are-designated","title":"Ensure that between two and four global admins are designated","text":"<p>Microsoft recommande d\u2019avoir moins de 5 Global Administrators. Il faut utiliser les diff\u00e9rents - et nombreux - r\u00f4les pour attribuer les permissions n\u00e9cessaires aux administrateurs selon le principe de \u00ab Least Privilege \u00bb.</p>"},{"location":"Azure/#ensure-self-service-password-reset-is-enabled","title":"Ensure self-service password reset is enabled","text":"<p>L'activation de la r\u00e9initialisation du mot de passe en libre-service permet aux utilisateurs de r\u00e9initialiser leurs propres mots de passe dans Azure AD. Lorsque vos utilisateurs se connectent \u00e0 Microsoft 365, ils sont invit\u00e9s \u00e0 entrer des informations de contact suppl\u00e9mentaires qui les aideront \u00e0 r\u00e9initialiser leur mot de passe \u00e0 l'avenir.</p> <p>Portal Azure AD</p> <p></p>"},{"location":"Azure/#ensure-custom-banned-passwords-lists-are-used","title":"Ensure custom banned passwords lists are used","text":"<p>Ajouter une banlist de mots de passe communs permet de s\u2019assurer que les utilisateurs choisissent un mot de passe qui, en plus de respecter les exigences de complexit\u00e9 standard, ne se trouve pas dans une liste des mots de passe les plus fr\u00e9quemment utilis\u00e9s. Ces listes, commun\u00e9ment appel\u00e9es \u00ab Dictionnaires \u00bb, sont disponibles publiquement sur Internet.</p> <p>Portal Azure AD</p> <p></p>"},{"location":"Azure/#ensure-password-protection-is-enabled-for-on-prem-active-directory","title":"Ensure password protection is enabled for on-prem Active Directory","text":"<p>Activer la protection par mot de passe Azure Active Directory \u00e0 ActiveDirectory pour prot\u00e9ger contre l'utilisation de mots de passe courants. Remarque : Cette recommandation s'applique uniquement aux d\u00e9ploiements hybrides et n'aura aucun impact sans un Active Directory on-premises.</p> <p>Portal Azure AD</p> <p></p>"},{"location":"Azure/#enable-conditional-access-policies-to-block-legacy-authentication","title":"Enable Conditional Access policies to block legacy authentication","text":"<p>Les anciens protocoles qui ne permettent pas d\u2019appliquer de s\u00e9curit\u00e9 (MFA) au moment de l\u2019authentification pr\u00e9sentent un important probl\u00e8me de s\u00e9curit\u00e9 vu que le MFA est bypass\u00e9. Attention : D\u00e8s octobre 2022, Microsoft d\u00e9sactive petit \u00e0 petit l\u2019authentification legacy sur tous les tenants !</p> <p>il faut utiliser une CA</p>"},{"location":"Azure/#ensure-that-password-hash-sync-is-enabled-for-hybrid-deployments","title":"Ensure that password hash sync is enabled for hybrid deployments","text":"<p>Activer la synchronisation des hashs des mots de passe afin de ne conserver qu\u2019un mot de passe par utilisateur et permet de d\u00e9tecter le credential leak en identifiant si les mots de passe des comptes utilisateurs d'une organisation sont apparus sur le dark web ou dans des espaces publics. Remarque : Cette recommandation s'applique uniquement aux d\u00e9ploiements hybrides et n'aura aucun impact sans un Active Directory on-premises.</p> <p>Microsoft Entra ID</p> <p></p>"},{"location":"Azure/#enable-azure-ad-identity-protection-sign-in-risk-policies","title":"Enable Azure AD Identity Protection sign-in risk policies","text":"<p>Azure Active Directory Identity Protection sign-in risk d\u00e9tecte les risques en temps r\u00e9el et hors ligne. Une ouverture de session \u00e0 risque est un indicateur d'une tentative d'ouverture de session qui pourrait ne pas avoir \u00e9t\u00e9 effectu\u00e9e par le propri\u00e9taire l\u00e9gitime d'un compte utilisateur. L'activation de la policy de risque d'ouverture de session garantit que les ouvertures de session suspectes font l'objet d'une demande d'authentification multi-facteur.</p> <p>Activer les sign-in policies (de pr\u00e9f\u00e9rence depuis des r\u00e8gles de Conditional Access).</p> <p>Portal Auzre AD</p> <p></p>"},{"location":"Azure/#enable-azure-ad-identity-protection-user-risk-policies","title":"Enable Azure AD Identity Protection user risk policies","text":"<p>Lorsque la policy user-risk est activ\u00e9e, Azure AD d\u00e9tecte la probabilit\u00e9 qu'un compte utilisateur soit compromis. En tant qu'administrateur, vous pouvez configurer une policy d\u2019acc\u00e8s conditionnel pour r\u00e9pondre automatiquement \u00e0 un niveau de risque sp\u00e9cifique pour les utilisateurs. Par exemple, vous pouvez bloquer l'acc\u00e8s \u00e0 vos ressources ou exiger un changement de mot de passe pour repasser un compte \u00e0 un \u00e9tat \u00ab propre \u00bb (non risqu\u00e9).</p> <p>Activer les sign-in policies (de pr\u00e9f\u00e9rence depuis des r\u00e8gles de Conditional Access).</p>"},{"location":"Azure/#ensure-privileged-identity-management-is-used-to-manage-roles","title":"Ensure 'Privileged Identity Management' is used to manage roles","text":"<p>La gestion des identit\u00e9s privil\u00e9gi\u00e9es Azure Active Directory peut \u00eatre utilis\u00e9e pour auditer les r\u00f4les, permettre l'activation \u00ab Just In Time \u00bb des r\u00f4les et permettre la revue p\u00e9riodique des r\u00f4les. Les organisations devraient retirer les membres permanents des r\u00f4les privil\u00e9gi\u00e9s d'Office 365 et, au contraire, les rendre \u00e9ligibles par le biais d'un workflow d'activation Just In Time.</p> <p>Les r\u00f4les sensibles suivants devraient \u00eatre soumis au \u00ab Just In time \u00bb de mani\u00e8re syst\u00e9matique :</p> <ul> <li>Application Administrator</li> <li>Authentication Administrator</li> <li>Billing Administrator</li> <li>Cloud Application Administrator </li> <li>Cloud Device Administrator </li> <li>Compliance Administrator </li> <li>Customer LockBox</li> <li>Access Approver</li> <li>Device Administrators</li> <li>Exchange Administrators</li> <li>Global Administrators</li> <li>HelpDesk Administrator</li> <li>Information Protection Administrator </li> <li>Intune Service Administrator</li> <li>Kaizala Administrator</li> <li>License Administrator</li> <li>Password Administrator</li> <li>PowerBI Service Administrator </li> <li>Privileged Authentication Administrator </li> <li>Privileged Role Administrator</li> <li>Security Administrator</li> <li>SharePoint Service Administrator</li> <li>Skype for Business Administrator </li> <li>Teams Service Administrator</li> <li>User Administrator</li> </ul>"},{"location":"Azure/#ensure-that-only-organizationally-managedapproved-public-groups-exist","title":"Ensure that only organizationally managed/approved public groups exist","text":"<p>Microsoft 365 Groups permet de donner \u00e0 un groupe de personnes l'acc\u00e8s \u00e0 une collection de ressources partag\u00e9es. Bien qu'il existe plusieurs types de groupes, cette recommandation concerne les groupes Microsoft 365. Dans le panneau d'administration, lorsqu'un groupe est cr\u00e9\u00e9, la valeur de confidentialit\u00e9 par d\u00e9faut est \"Public\". Un utilisateur peut ainsi acc\u00e9der aux donn\u00e9es de ce groupe : - En utilisant le portail Azure et en s'ajoutant au groupe public - En demandant l'acc\u00e8s au groupe \u00e0 partir de l'application \u00ab Group \u00bb - En acc\u00e9dant \u00e0 l'URL SharePoint</p> <p>Lien Dashboard M365 : https://admin.microsoft.com/#/groups</p> <p>Recomandations:</p> <ul> <li>S\u2019assurer que tous les groupes param\u00e9tr\u00e9s \u00ab publics \u00bb le sont \u00e0 dessein et modifier la configuration de chaque groupe vers \u00ab priv\u00e9 \u00bb dans le cas contraire.</li> <li>Revoir p\u00e9riodiquement les groupes publics.</li> </ul>"},{"location":"Azure/#ensure-that-collaboration-invitations-are-sent-to-allowed-domains-only","title":"Ensure that collaboration invitations are sent to allowed domains only","text":"<p>Les utilisateurs doivent pouvoir envoyer des invitations de collaboration uniquement aux domaines autoris\u00e9s. En sp\u00e9cifiant les domaines autoris\u00e9s pour les collaborations, les externes sont explicitement identifi\u00e9s. En outre, cela emp\u00eache les utilisateurs internes d'inviter des utilisateurs externes inconnus, tels que des comptes personnels, et de leur donner acc\u00e8s \u00e0 des ressources.</p> <p>Lien Dashboard M365 : https://aad.portal.azure.com/</p> <p>Recommandations:</p> <ul> <li>D\u00e9terminer une liste de domaines autoris\u00e9s \u00e0 l\u2019invitation de guests.</li> <li>Revoir p\u00e9riodiquement la liste des domaines.</li> </ul>"},{"location":"Azure/#ensure-linkedin-account-connections-is-disabled","title":"Ensure 'LinkedIn account connections' is disabled","text":"<p>L'int\u00e9gration avec LinkedIn doit \u00eatre d\u00e9sactiv\u00e9e afin d'\u00e9viter les attaques par phishing. Office 365 est la cible privil\u00e9gi\u00e9e des attaques par phishing. Les sites de r\u00e9seaux sociaux ont rendu les attaques d'ing\u00e9nierie sociale plus faciles \u00e0 mener. L'int\u00e9gration de LinkedIn est activ\u00e9e par d\u00e9faut dans Office 365, ce qui pourrait conduire \u00e0 un sc\u00e9nario \u00e0 risque o\u00f9 des informations sensibles pourraient \u00eatre exfiltr\u00e9es par ce biais.</p> <p>Lien Dashboard M365 : https://aad.portal.azure.com/</p> <p>Portal Azure AD</p> <p></p>"},{"location":"Azure/#ensure-the-option-to-remain-signed-in-is-hidden","title":"Ensure the option to remain signed in is hidden","text":"<p>Lorsque l\u2019utilisateur peut choisir l\u2019option de rester connect\u00e9, un token de persistance pouvant \u00eatre valide jusqu\u2019\u00e0 90 jours est cr\u00e9\u00e9, et ne prompte plus l\u2019utilisateur ni \u00e0 se connecter, ni \u00e0 entrer un deuxi\u00e8me facteur. Dans le cas o\u00f9 un utilisateur se connecte depuis une machine publiquement accessible, il serait trivial pour un attaquant d'acc\u00e9der \u00e0 toutes les donn\u00e9es du cloud associ\u00e9es \u00e0 ce compte.</p> <p>Lien Dashboard M365 : https://portal.azure.com/</p> <p></p>"},{"location":"Azure/#ensure-restrict-access-to-the-azure-ad-administration-portal-is-set-to-yes","title":"Ensure 'Restrict access to the Azure AD administration portal' is set to 'Yes'","text":"<p>Interdire aux utilisateurs non privil\u00e9gi\u00e9s de se connecter au portail Azure Active Directory. Par d\u00e9faut, un utilisateur final peut se connecter au portail AAD, et modifier par inadvertance des param\u00e8tres administrateur ou les param\u00e8tres du compte. En outre, un compte d'utilisateur final compromis pourrait \u00eatre utilis\u00e9 par un attaquant malveillant pour recueillir des informations suppl\u00e9mentaires et escalader une crise. REMARQUE : Les utilisateurs pourront toujours se connecter au centre d'administration Azure Active Directory mais ne pourront pas consulter les informations du portail.</p> <p>Lien Dashboard M365 : https://portal.azure.com/</p> <p>Azure AAD portal</p> <p></p>"},{"location":"Azure/#ensure-microsoft-azure-management-is-limited-to-administrative-roles","title":"Ensure 'Microsoft Azure Management' is limited to administrative roles","text":"<p>Microsoft Azure Management doit \u00eatre limit\u00e9 \u00e0 des r\u00f4les administratifs sp\u00e9cifiques pr\u00e9d\u00e9termin\u00e9s, emp\u00eachant les utilisateurs non privil\u00e9gi\u00e9s de se connecter \u00e0 la plupart des portails autres que Microsoft 365 Defender et Microsoft Purview. L\u2019application de ce param\u00e8tre impacte les services suivants : </p> <ul> <li>Classic deployment model APIs</li> <li>Azure PowerShell</li> <li>Azure CLI</li> <li>Azure DevOps</li> <li>Azure Data Factory portal</li> <li>Azure Event Hubs</li> <li>Azure Service Bus</li> <li>Azure SQL Database</li> <li>SQL Managed Instance</li> <li>Azure Synapse</li> <li>Visual Studio subscriptions administrator portal</li> <li>Microsoft IoT Central</li> </ul>"},{"location":"Azure/#compte-brise-glace-azure","title":"Compte Brise glace Azure","text":"<p>Le r\u00f4le d'administrateur global doit \u00eatre attribu\u00e9 de fa\u00e7on permanente. Le mot de passe ne doit pas expirer. MFA ne doit pas \u00eatre activ\u00e9 sur ce compte. Le compte doit \u00eatre exclu de TOUTES les politiques d'acc\u00e8s conditionnel. Il ne doit pas \u00eatre assign\u00e9 \u00e0 une personne en particulier. Ce compte ne doit servir que pour le cloud. Il faut utiliser le domaine du tenant par d\u00e9faut \u00ab onmicrosoft.com \u00bb (pour \u00e9viter tous les probl\u00e8mes de domaine et de f\u00e9d\u00e9ration). Il ne doit donc pas \u00eatre f\u00e9d\u00e9r\u00e9 ni synchronis\u00e9 avec l\u2019AD on-premises. Ce compte ne doit pas \u00eatre associ\u00e9 \u00e0 des t\u00e9l\u00e9phones mobiles ou des jetons mat\u00e9riels fournis par les employ\u00e9s.</p>"},{"location":"Controles-CIS/","title":"M365/AAD","text":"<p>Work In Progess !!</p>"},{"location":"Controles-CIS/#account-authentication","title":"Account / Authentication","text":""},{"location":"Controles-CIS/#111-ensure-security-defaults-is-disabled-on-azure-active-directory","title":"1.1.1 Ensure Security Defaults is disabled on Azure Active Directory","text":"<p>Description:</p> <p>Par d\u00e9faut, Microsoft active les param\u00e8tres de s\u00e9curit\u00e9 par d\u00e9faut. L'objectif est de s'assurer que toutes les organisations disposent d'un niveau de s\u00e9curit\u00e9 de base.</p> <p>Cependant, l'utilisation des param\u00e8tres de s\u00e9curit\u00e9 par d\u00e9faut emp\u00eache l\u2019application de param\u00e8tres personnalis\u00e9s qui sont recommand\u00e9s d\u2019\u00eatre d\u00e9finis dans ce benchmark.</p> <p>D\u00e9monstration</p> <p></p>"},{"location":"Controles-CIS/#112-ensure-multifactor-authentication-is-enabled-for-all-users-in-administrative-roles","title":"1.1.2 Ensure multifactor authentication is enabled for all users in administrative roles","text":""},{"location":"Controles-CIS/#113-ensure-sign-in-frequency-is-enabled-and-browser-sessions-are-not-persistent-for-administrative-users","title":"1.1.3 Ensure Sign-in frequency is enabled and browser sessions are not persistent for Administrative users.","text":""},{"location":"Controles-CIS/#114-ensure-multifactor-authentication-is-enabled-for-all-users-in-all-roles","title":"1.1.4 Ensure multifactor authentication is enabled for all users in all roles","text":""},{"location":"Controles-CIS/#115-ensure-microsoft-authenticator-is-configured-to-protect-against-mfa-fatigue","title":"1.1.5 Ensure Microsoft Authenticator is configured to protect against MFA fatigue","text":""},{"location":"Controles-CIS/#116-ensure-phishing-resistant-mfa-strength-is-required-for-administrators","title":"1.1.6 Ensure 'Phishing-resistant MFA strength' is required for Administrators","text":""},{"location":"Controles-CIS/#117-ensure-that-between-two-and-four-global-admins-are-designated","title":"1.1.7 Ensure that between two and four global admins are designated","text":""},{"location":"Controles-CIS/#118-ensure-self-service-password-reset-is-enabled","title":"1.1.8 Ensure self-service password reset is enabled","text":""},{"location":"Controles-CIS/#119-ensure-custom-banned-passwords-lists-are-used","title":"1.1.9 Ensure custom banned passwords lists are used","text":""},{"location":"Controles-CIS/#1110-ensure-password-protection-is-enabled-for-on-prem-active-directory","title":"1.1.10 Ensure password protection is enabled for on-prem Active Directory","text":""},{"location":"Controles-CIS/#1111-enable-conditional-access-policies-to-block-legacy-authentication","title":"1.1.11 Enable Conditional Access policies to block legacy authentication","text":""},{"location":"Controles-CIS/#1112-ensure-that-password-hash-sync-is-enabled-for-hybrid-deployments","title":"1.1.12 Ensure that password hash sync is enabled for hybrid deployments","text":""},{"location":"Controles-CIS/#1113-enable-azure-ad-identity-protection-sign-in-risk-policies","title":"1.1.13 Enable Azure AD Identity Protection sign-in risk policies","text":""},{"location":"Controles-CIS/#1114-enable-azure-ad-identity-protection-user-risk-policies","title":"1.1.14 Enable Azure AD Identity Protection user risk policies","text":""},{"location":"Controles-CIS/#1115-ensure-privileged-identity-management-is-used-to-manage-roles","title":"1.1.15 Ensure 'Privileged Identity Management' is used to manage roles","text":""},{"location":"Controles-CIS/#1116-ensure-that-only-organizationally-managedapproved-public-groups-exist","title":"1.1.16 Ensure that only organizationally managed/approved public groups exist","text":""},{"location":"Controles-CIS/#1117-ensure-that-collaboration-invitations-are-sent-to-allowed-domains-only","title":"1.1.17 Ensure that collaboration invitations are sent to allowed domains only","text":""},{"location":"Controles-CIS/#1118-ensure-linkedin-account-connections-is-disabled","title":"1.1.18 Ensure 'LinkedIn account connections' is disabled","text":""},{"location":"Controles-CIS/#1119-ensure-the-option-to-remain-signed-in-is-hidden","title":"1.1.19 Ensure the option to remain signed in is hidden","text":""},{"location":"Controles-CIS/#1120-ensure-restrict-access-to-the-azure-ad-administration-portal-is-set-to-yes","title":"1.1.20 Ensure 'Restrict access to the Azure AD administration portal' is set to 'Yes'","text":""},{"location":"Controles-CIS/#1121-ensure-microsoft-azure-management-is-limited-to-administrative-roles","title":"1.1.21 Ensure 'Microsoft Azure Management' is limited to administrative roles","text":""},{"location":"Controles-CIS/#1122-ensure-restrict-non-admin-users-from-creating-tenants-is-set-to-yes","title":"1.1.22 Ensure 'Restrict non-admin users from creating tenants' is set to 'Yes'","text":""},{"location":"Controles-CIS/#12-ensure-modern-authentication-for-exchange-online-is-enabled","title":"1.2 Ensure modern authentication for Exchange Online is enabled","text":""},{"location":"Controles-CIS/#13-ensure-modern-authentication-for-sharepoint-applications-is-required","title":"1.3 Ensure modern authentication for SharePoint applications is required","text":""},{"location":"Controles-CIS/#14-ensure-the-password-expiration-policy-is-set-to-set-passwords-to-never-expire","title":"1.4 Ensure the 'Password expiration policy' is set to 'Set passwords to never expire\u2019","text":""},{"location":"Controles-CIS/#15-ensure-administrative-accounts-are-separate-and-cloud-only","title":"1.5 Ensure Administrative accounts are separate and cloud-only.","text":""},{"location":"Controles-CIS/#16-ensure-two-emergency-access-accounts-have-been-defined","title":"1.6 Ensure two emergency access accounts have been defined","text":""},{"location":"Controles-CIS/#17-ensure-idle-session-timeout-is-set-to-1-hour-or-less-for-unmanaged-devices","title":"1.7 Ensure 'Idle session timeout' is set to '1 hour (or less)' for unmanaged devices","text":""},{"location":"Controles-CIS/#1n1-mfa-methods-disable-mfa-via-sms-and-phone-calls","title":"1.N.1 MFA methods - Disable MFA via SMS and phone calls","text":""},{"location":"Controles-CIS/#1n2-disable-mfa-app-passwords","title":"1.N.2 Disable MFA \u201capp passwords\u201d","text":""},{"location":"Controles-CIS/#1n3-restrict-creation-of-m365-groups","title":"1.N.3 Restrict creation of M365 groups","text":""},{"location":"Controles-CIS/#1n4-housekeeping-delete-unused-groups","title":"1.N.4 Housekeeping - Delete unused groups","text":""},{"location":"Controles-CIS/#1n5-dont-allow-guests-to-invite-other-guests","title":"1.N.5 Don't allow guests to invite other guests","text":""},{"location":"Controles-CIS/#application-permissions","title":"Application Permissions","text":""},{"location":"Controles-CIS/#21-ensure-the-admin-consent-workflow-is-enabled","title":"2.1 Ensure the admin consent workflow is enabled","text":""},{"location":"Controles-CIS/#22-ensure-third-party-integrated-applications-are-not-allowed","title":"2.2 Ensure third party integrated applications are not allowed.","text":""},{"location":"Controles-CIS/#23-ensure-external-sharing-of-calendars-is-not-available","title":"2.3 Ensure 'External sharing' of calendars is not available","text":""},{"location":"Controles-CIS/#24-ensure-safe-links-for-office-applications-is-enabled","title":"2.4 Ensure Safe Links for Office Applications is Enabled","text":""},{"location":"Controles-CIS/#25-ensure-safe-attachments-for-sharepoint-onedrive-and-microsoft-teams-is-enabled","title":"2.5 Ensure Safe Attachments for SharePoint, OneDrive, and Microsoft Teams is Enabled","text":""},{"location":"Controles-CIS/#26-ensure-office-365-sharepoint-infected-files-are-disallowed-for-download","title":"2.6 Ensure Office 365 SharePoint infected files are disallowed for download","text":""},{"location":"Controles-CIS/#27-ensure-user-consent-to-apps-accessing-company-data-on-their-behalf-is-not-allowed","title":"2.7 Ensure user consent to apps accessing company data on their behalf is not allowed","text":""},{"location":"Controles-CIS/#28-ensure-users-installing-outlook-add-ins-is-not-allowed","title":"2.8 Ensure users installing Outlook add-ins is not allowed","text":""},{"location":"Controles-CIS/#29-ensure-user-owned-apps-and-services-is-restricted","title":"2.9 Ensure 'User owned apps and services' is restricted","text":""},{"location":"Controles-CIS/#210-ensure-internal-phishing-protection-for-forms-is-enabled","title":"2.10 Ensure internal phishing protection for Forms is enabled","text":""},{"location":"Controles-CIS/#211-ensure-that-sways-cannot-be-shared-with-people-outside-of-your-organization","title":"2.11 Ensure that Sways cannot be shared with people outside of your organization","text":"<p>Description D\u00e9sactiver le partage externe d'\u00e9l\u00e9ments Sway (Microsoft Sway est un programme de pr\u00e9sentation qui vous permet de cr\u00e9er des diaporamas, des lettres d'information, CV, blogs, etc.) tels que des rapports, des bulletins d'information, des pr\u00e9sentations, etc. qui pourraient contenir des informations sensibles, afin d'\u00e9viter toute fuite de donn\u00e9es accidentelle ou arbitraire. Lien Dashboard M365 : https://admin.microsoft.com/#/Settings/Services/:/Settings/L1/Sway</p>"},{"location":"Controles-CIS/#212-ensure-sharepoint-and-onedrive-integration-with-azure-ad-b2b-is-enabled","title":"2.12 Ensure SharePoint and OneDrive integration with Azure AD B2B is enabled","text":""},{"location":"Controles-CIS/#2n1-external-sharing-management","title":"2.N.1 External sharing management","text":""},{"location":"Controles-CIS/#2n2-do-not-automatically-admit-guests-to-teams-meetings","title":"2.N.2 Do not automatically admit guests to Teams meetings","text":""},{"location":"Controles-CIS/#2n3-do-not-allow-guests-to-start-a-meeting","title":"2.N.3 Do not allow guests to start a meeting","text":""},{"location":"Controles-CIS/#2n4-contact-by-private-users","title":"2.N.4 Contact by \"private\" users","text":""},{"location":"Controles-CIS/#data-management","title":"Data Management","text":""},{"location":"Controles-CIS/#31-ensure-the-customer-lockbox-feature-is-enabled","title":"3.1 Ensure the customer lockbox feature is enabled","text":""},{"location":"Controles-CIS/#32-ensure-sharepoint-online-information-protection-policies-are-set-up-and-used","title":"3.2 Ensure SharePoint Online Information Protection policies are set up and used","text":""},{"location":"Controles-CIS/#33-ensure-external-access-is-restricted-in-the-teams-admin-center","title":"3.3 Ensure 'external access' is restricted in the Teams admin center","text":""},{"location":"Controles-CIS/#34-ensure-dlp-policies-are-enabled","title":"3.4 Ensure DLP policies are enabled","text":""},{"location":"Controles-CIS/#35-ensure-dlp-policies-are-enabled-for-microsoft-teams","title":"3.5 Ensure DLP policies are enabled for Microsoft Teams","text":""},{"location":"Controles-CIS/#36-ensure-that-sharepoint-guest-users-cannot-share-items-they-dont-own","title":"3.6 Ensure that SharePoint guest users cannot share items they don't own","text":""},{"location":"Controles-CIS/#37-ensure-external-file-sharing-in-teams-is-enabled-for-only-approved-cloud-storage-services","title":"3.7 Ensure external file sharing in Teams is enabled for only approved cloud storage services","text":""},{"location":"Controles-CIS/#email-security-exchange-online","title":"Email Security / Exchange Online","text":"<p>4.1 Ensure external file sharing in Teams is enabled for only approved cloud storage services 4.2 Ensure Exchange Online Spam Policies are set to notify administrators 4.3 Ensure all forms of mail forwarding are blocked and/or disabled 4.4 Ensure mail transport rules do not whitelist specific domains 4.5 Ensure Safe Attachments policy is enabled 4.6 Ensure that an anti-phishing policy has been created 4.7 Ensure that DKIM is enabled for all Exchange Online Domains 4.8 Ensure that SPF records are published for all Exchange Domains 4.9 Ensure DMARC Records for all Exchange Online domains are published 4.10 Ensure notifications for internal users sending malware is Enabled 4.11 Ensure MailTips are enabled for end users 4.12 Ensure Priority account protection is enabled and configured 4.13 Ensure Priority accounts have 'Strict protection' presets applied</p>"},{"location":"Controles-CIS/#auditing","title":"Auditing","text":"<p>5.1.1 Ensure 'Access reviews' for Guest Users are configured 5.1.2 Ensure 'Access reviews' for high privileged Azure AD roles are configured 5.2 Ensure Microsoft 365 audit log search is Enabled 5.3 Ensure mailbox auditing for all users is Enabled 5.4 Ensure the Azure AD 'Risky sign-ins' report is reviewed at least weekly 5.5 Ensure the Application Usage report is reviewed at least weekly 5.6 Ensure the self-service password reset activity report is reviewed at least weekly 5.7 Ensure user role group changes are reviewed at least weekly 5.8 Ensure mail forwarding rules are reviewed at least weekly 5.9 Ensure all security threats in the Threat protection status report are reviewed at least weekly 5.10 Ensure the Account Provisioning Activity report is reviewed at least weekly 5.11 Ensure non-global administrator role group assignments are reviewed at least weekly 5.12 Ensure the spoofed domains report is reviewed weekly 5.13 Ensure Microsoft Defender for Cloud Apps is enabled and configured 5.14 Ensure the 'Restricted entities' report is reviewed weekly 5.15 Ensure Guest Users are reviewed at least biweekly</p>"},{"location":"Controles-CIS/#storage","title":"Storage","text":"<p>6.1 Ensure SharePoint external sharing is managed through domain whitelist/blacklists 6.2 Block OneDrive for Business sync from unmanaged devices 6.3 Ensure expiration time for external sharing links is set 6.4 Ensure 'third-party storage services' are restricted in 'Microsoft 365 on the web\u2019 6.5 Ensure additional storage providers are restricted in Outlook on the web</p>"},{"location":"Cybereason/","title":"Cybereason","text":"<ol> <li>L\u2019Antivirus Il est construit \u00e0 partir de deux modules pr\u00e9cis : un engin et une biblioth\u00e8que de d\u00e9finition. </li> <li>Tout d\u2019abord, l\u2019engin v\u00e9rifie chaque fichier de votre appareil et il compare les codes de chacun d\u2019entre eux avec ceux de la biblioth\u00e8que de signature. Ensuite, lorsqu\u2019un fichier est identifi\u00e9 comme \u00e9tant dangereux, il est plac\u00e9 en quarantaine et est isol\u00e9 du syst\u00e8me d\u2019exploitation. </li> <li> <p>Si l\u2019antivirus connait la m\u00e9thode de nettoyage, il l\u2019ex\u00e9cutera. Dans le cas contraire, il lancera une alerte afin que l\u2019utilisateur puisse intervenir.</p> </li> <li> <p>Endpoint Detection &amp; Response (EDR)</p> </li> <li>Contrairement \u00e0 l\u2019antivirus, l\u2019EDR effectue une analyse comportementale des menaces. </li> <li>Il analyse l\u2019ex\u00e9cution et il d\u00e9termine s\u2019il s\u2019agit d\u2019une menace. Toutefois, cette op\u00e9ration n\u2019est pas bas\u00e9e sur une biblioth\u00e8que pr\u00e9alablement install\u00e9e, mais plut\u00f4t sur l\u2019incidence que le code aura sur\u00a0votre\u00a0appareil et ce, peu importe le type!</li> <li>Ajoute une corr\u00e9lation entre les \u00e9v\u00e9nements de s\u00e9curit\u00e9 en arri\u00e8re-plan et l\u2019intelligence artificielle afin de traiter les grands nombres de signaux.</li> </ol> <p>MalOp, malicious operation, is\u00a0the complete set of events taking place in a hacking operation. </p> <p>Ensemble d'\u00e9v\u00e9nements ayant lieu dans une op\u00e9ration de piratage.</p> <p>A MalOp includes the attack's root cause, the timeline of spread, the involved malware and other adversarial activities, malicious communication and the affected endpoints and users asd</p>"},{"location":"Cybereason/#services-cybereason","title":"Services Cybereason","text":"Uninstall Cybereason<pre><code>CybereasonSensor64_18_1_102_443_ACTIVE_NORMAL.exe\u00a0/uninstall /quiet -l C:\\Temp\\CybereasonInstall.log AP_UNINSTALL_CODE=\"9bmNs08*9Iuo^Rrz\"\n</code></pre> Upgrade Cybereason<pre><code>CybereasonSensor64_18_1_102_443_ACTIVE_NORMAL.exe AP_UNINSTALL_CODE=\"9xxxx\"\n</code></pre>"},{"location":"FileCheck/","title":"Scripts-Checks","text":""},{"location":"FileCheck/#file-checks-in-powershell","title":"File checks in powershell","text":"A basic file check (in case you\u2019re feeling scripty)<pre><code>$File = \"C:\\windows\\system32\\notepad.exe\"\nif (Test-Path $File) {\n    write-output \"Notepad detected, exiting\"\n    exit 0\n}\nelse {\n    exit 1\n}\n</code></pre> A registry key (checking both it exists and the value is correct, good for versioning)<pre><code>$Path = \"HKLM:\\SOFTWARE\\7-Zip\"\n$Name = \"Path\"\n$Type = \"STRING\"\n$Value = \"C:\\Program Files\\7-Zip\\\"\n\nTry {\n    $Registry = Get-ItemProperty -Path $Path -Name $Name -ErrorAction Stop | Select-Object -ExpandProperty $Name\n    If ($Registry -eq $Value){\n        Write-Output \"Detected\"\n       Exit 0\n    } \n    Exit 1\n} \nCatch {\n    Exit 1\n}\n</code></pre> Check if a service exists<pre><code>$service = get-service -name \"MozillaMaintenance\"\nif ($service) {\n    write-output \"MozillaMaintenance detected, exiting\"\n    exit 0\n}\nelse {\n    exit 1\n}\n</code></pre> Service exists and is running<pre><code>$service = get-service -name \"MozillaMaintenance\"\nif ($service.Status -eq \"Running\") {\n    write-output \"MozillaMaintenance detected and running, exiting\"\n    exit 0\n}\nelse {\n   exit 1\n}\n</code></pre> Both file and service exist<pre><code>$File = \"C:\\windows\\system32\\notepad.exe\"\n$service = get-service -name \"MozillaMaintenance\"\nif (($service) -and (Test-Path $File)) {\n    write-output \"MozillaMaintenance and Notepad detected, exiting\"\n    exit 0\n}\nelse {\n    exit 1\n}\n</code></pre> File is of a certain version<pre><code>$fileversion = (Get-Command C:\\Windows\\System32\\notepad.exe).Version\n$build = 19041\n$detectedbuild = $fileversion.Build\nif ($detectedbuild -eq $build) {\n    write-output \"Detected\"\n    exit 0\n}\nelse {\n    exit 1\n}\n</code></pre> Or even the file was last modified today<pre><code>$filedate = (Get-Item C:\\Windows\\System32\\notepad.exe).LastWriteTime\nif ($filedate -gt (Get-Date).AddDays(-1)) {\n    write-output \"Detected\"\n    exit 0\n}\nelse {\n    exit 1\n}\n</code></pre> When looking at logged in user, we need to find their details so for this I have a new function<pre><code>function getloggedindetails() {\n    ##Find logged in username\n    $user = Get-WmiObject Win32_Process -Filter \"Name='explorer.exe'\" |\n      ForEach-Object { $_.GetOwner() } |\n      Select-Object -Unique -Expand User\n\n    ##Find logged in user's SID\n    ##Loop through registry profilelist until ProfileImagePath matches and return the path\n        $path= \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList\\*\"\n        $sid = (Get-ItemProperty -Path $path | Where-Object { $_.ProfileImagePath -like \"*$user\" \n}).PSChildName\n\n    $return = $sid, $user\n\n    return $return\n    }\n</code></pre> Running this will give you the username and SID. For our 7-zip registry example:<pre><code>$loggedinuser = getloggedindetails\n##Set key\n\n$sid = $loggedinuser[0]\n$Path = \"Registry::HKU\\$sid\\SOFTWARE\\7-Zip\"\n$Name = \"Path\"\n$Type = \"STRING\"\n$Value = \"C:\\Program Files\\7-Zip\\\"\n\nTry {\n    $Registry = Get-ItemProperty -Path $Path -Name $Name -ErrorAction Stop | Select-Object -ExpandProperty $Name\n    If ($Registry -eq $Value){\n        Write-Output \"Detected\"\n       Exit 0\n    } \n    Exit 1\n} \nCatch {\n    Exit 1\n        write-host \"not detected\"\n    write-host $path\n}\n</code></pre> Or for a file at the user level:<pre><code>$username = $loggedinuser[1]\n$File = \"C:\\users\\$username\\AppData\\Local\\Microsoft\\Teams\\update.exe\"\nif (Test-Path $File) {\n    write-output \"Teams Update detected, exiting\"\n    exit 0\n}\nelse {\n    exit 1\n}\n</code></pre>"},{"location":"Fortinet/","title":"Fortinet","text":"<p>Desactiver les vieux TLS ==&gt; For HTTPS<pre><code>config sys global  \nset strong-crypto enable  \nset admin-https-ssl-versions tlsv1-2 tlsv1-3   \nend\n</code></pre> Desactiver les vieux TLS ==&gt; For SSL-VPN<pre><code>config vpn ssl settings  \nset ssl-min-proto-ver tls1-2  \nset ssl-max-proto-ver tls1-3    \nend\n</code></pre></p> <p>Require TLS 1.2 for HTTPS administrator access to the GUI<pre><code>config system global\nset admin-https-ssl-versions tlsv1-2\nend\nTLS 1.2 is currently the most secure SSL/TLS supported version for SSL-encrypted administrator access.\n</code></pre> ```title=\"Re-direct HTTP GUI logins to HTTPS. Go to System &gt; Settings &gt; Administrator Settings and enable Redirect to HTTPS to make sure that all attempted HTTP login connections are redirected to HTTPS.\" config system global set admin-https-redirect enable end <pre><code>```title=\"Diag sniffer les packets en CLI\"\ndiag sniffer packet any \"host 172.21.61.178 and icmp\" 4\n</code></pre></p>"},{"location":"GPOs/","title":"Common GPOs","text":""},{"location":"GPOs/#allow-rdp-for-domain-admins","title":"Allow RDP for Domain admins","text":""},{"location":"GPOs/#enable-the-remote-desktop-session-host-policies","title":"Enable the Remote Desktop Session Host policies","text":""},{"location":"GPOs/#enable-network-level-authentication","title":"Enable Network Level Authentication","text":""},{"location":"GPOs/#force-numlock-on-windows-10","title":"Force NumLock on Windows 10","text":"<pre><code>Key Path: .DEFAULT\\Control Panel\\Keyboard\nValue data: 2\n</code></pre>"},{"location":"GPOs/#creer-des-filtres-gpo-pour-cibles-certains-types-de-machines","title":"Creer des filtres GPO pour cibles certains types de machines","text":"<p>Il faut utiliser des filtres WMI</p> <p>filtres WMI</p>"},{"location":"GPOs/#tools","title":"Tools","text":"<p>rsop.msc</p>"},{"location":"Intune/","title":"What is Intune","text":""},{"location":"Intune/#manually-register-devices-for-windows-autopilot","title":"Manually register devices for Windows Autopilot","text":"<p>ALT + F10 on windows boot apres avoir selectionner la bonne langue de clavier</p> <p>Start powershell from CMD<pre><code>PowerShell.exe\n</code></pre> Install Get-WindowsAutopilotInfo.ps1<pre><code>Install-Script -name Get-WindowsAutopilotInfo -Force\n</code></pre> Change the persimission to allow the scripts to run<pre><code>Set-ExecutionPolicy -Scope Process -ExecutionPolicy RemoteSigned\n</code></pre> Register the device<pre><code>Get-WindowsAutopilotInfo -Online\n</code></pre> Full script<pre><code>Install-Script -name Get-WindowsAutopilotInfo -Force\nSet-ExecutionPolicy -Scope Process -ExecutionPolicy RemoteSigned\nGet-WindowsAutopilotInfo -Online\n</code></pre></p> <p>References: Manually register devices with Windows Autopilot | Microsoft Learn</p>"},{"location":"Intune/#apps-packaging","title":"Apps Packaging","text":"<p>Template intune Application Infos<pre><code>Display Name: Adobe Acrobat Reader DC\nDisplay Version: 23.003.20244.0\nPublisher: Adobe Systems Incorporated\nDisk Space Required: 500mb\n\nInstall: Setup.exe -s /msi /L*v \"C:\\ProgramData\\PG\\Logs\\Intune-Adobe-Acrobat-Reader-Install.log\"\nUninstall: MsiExec.exe /X{AC76BA86-7AD7-FFFF-7B44-AC0F074E4100} /qn /norestart /L*v \"C:\\ProgramData\\PG\\Logs\\Intune-Adobe-Acrobat-Reader-UnInstall.log\"\nDetection Method: {AC76BA86-7AD7-FFFF-7B44-AC0F074E4100}\n</code></pre> Check registry Value<pre><code>$KeyPath = \"HKCU:\\Registry\\Key\\Path\" \n$ValueName = \"name\" \n$ValueData = \"data\" \ntry{ \n    Get-ItemProperty -Path $KeyPath -Name $valueName -ErrorAction Stop \n} \ncatch [System.Management.Automation.ItemNotFoundException] { \n    New-Item -Path $KeyPath -Force New-ItemProperty -Path $KeyPath -Name $ValueName -Value $ValueData -Force \n} \ncatch { \n    New-ItemProperty -Path $KeyPath -Name $ValueName -Value $ValueData -Type String -Force \n} \n</code></pre></p>"},{"location":"Intune/#forticlient-package","title":"Forticlient package","text":"<pre><code># Name of the executable file\n$ExecName =  \"FortiClientVPNSetup_7.2.4.0972_x64.exe\"\n\n# Get the directory path of the current script\n$scriptPath = Split-Path -Parent $MyInvocation.MyCommand.Definition\n\n# Define the path to the executable file\n$executablePath = Join-Path -Path $scriptPath -ChildPath $ExecName\n\n# Check if the executable file exists\nif (Test-Path $executablePath -PathType Leaf) {\n    # Execute the executable file\n    Start-Process -FilePath $executablePath -ArgumentList \"/quiet /norestart\" -Wait\n} else {\n    Write-Host \"Executable file not found at: $executablePath\"\n}\n\n# Set VPN server and credentials\n$azureSSOSettings = @{\n    \"sso_enabled\" = 1\n    \"Server\" = \"myfipoi.fipoi.ch:443\"\n}\n\n# Configure Azure SSO settings\nif (Test-Path -LiteralPath $keyPath ) {\n    foreach ($setting in $azureSSOSettings.GetEnumerator()) {\n        Set-ItemProperty -Path $keyPath -Name $setting.Key -Value $setting.Value\n    }\n} else {\n    New-Item -Path $keyPath -Force -ea SilentlyContinue\n    foreach ($setting in $azureSSOSettings.GetEnumerator()) {\n        Set-ItemProperty -Path $keyPath -Name $setting.Key -Value $setting.Value\n    }\n}\n</code></pre>"},{"location":"Intune/#local-location-of-a-powershell-script","title":"Local location of a powershell script","text":"Get the directory path of the current script<pre><code># Get the directory path of the current script\n$scriptPath = Split-Path -Parent $MyInvocation.MyCommand.Definition\n\n# Define the path to the executable file\n$executablePath = Join-Path -Path $scriptPath -ChildPath $ExecName\n</code></pre>"},{"location":"Intune/#proactive-remediations-scrips","title":"Proactive Remediations scrips","text":""},{"location":"Intune/#adobe","title":"Adobe","text":"<p>DETECTION - Adobe Reader Document Bar for Microsoft AIP<pre><code>&lt;#\n.SYNOPSIS\n    PowerShell script to remediate the document message bar in Adobe Reader.\n.EXAMPLE\n    .\\UAT-Win10-01-Remediate-CplIntSettings.ps1\n.DESCRIPTION\n    This PowerShell script is deployed as a remediation script using Proactive Remediations in Microsoft Endpoint Manager/Intune.\n.LINK\nhttps://docs.microsoft.com/en-us/mem/analytics/proactive-remediations\nhttps://helpx.adobe.com/enterprise/kb/mpip-support-acrobat.html\n.NOTES\n    Version:        1.0\n    Creation Date:  July 25, 2023\n    Author:         JiPJab\n#&gt;\n\n[CmdletBinding()]\nParam (\n)\n\n$AdobeReaderKeyPath = @(\"HKCU:\\SOFTWARE\\Adobe\\Acrobat Reader\\DC\\MicrosoftAIP\")\n$ValueName = \"bShowDMB\"  \n$ValueData = 1  \ntry{  \n    Get-ItemProperty -Path $AdobeReaderKeyPath -Name $valueName -ErrorAction SilentlyContinue\n    Write-host 'Impossible de trouver HKCU:\\SOFTWARE\\Adobe\\Acrobat Reader\\DC\\MicrosoftAIP.'\n    Write-Verbose 'Impossible de trouver HKCU:\\SOFTWARE\\Adobe\\Acrobat Reader\\DC\\MicrosoftAIP.'\n    Exit 1\n}\nCatch {\n    $ErrorMessage = $_.Exception.Message \n    Write-Warning $ErrorMessage\n    Exit 1\n}\n</code></pre> REMEDIATION - Adobe Reader Document Bar for Microsoft AIP<pre><code>&lt;#\n.SYNOPSIS\n    PowerShell script to remediate the document message bar in Adobe Reader.\n.EXAMPLE\n    .\\UAT-Win10-01-Remediate-CplIntSettings.ps1\n.DESCRIPTION\n    This PowerShell script is deployed as a remediation script using Proactive Remediations in Microsoft Endpoint Manager/Intune.\n.LINK\nhttps://docs.microsoft.com/en-us/mem/analytics/proactive-remediations\nhttps://helpx.adobe.com/enterprise/kb/mpip-support-acrobat.html\n.NOTES\n    Version:        1.0\n    Creation Date:  July 25, 2023\n    Author:         JiPJaB\n#&gt;\n\n[CmdletBinding()]\nParam (\n)\n\n$AdobeReaderKeyPath = @(\"HKCU:\\SOFTWARE\\Adobe\\Acrobat Reader\\DC\\MicrosoftAIP\")\n$ValueName = \"bShowDMB\"  \n$ValueData = 1  \ntry{\n    New-Item -Path $AdobeReaderKeyPath -Force  \n    New-ItemProperty -Path $AdobeReaderKeyPath -Name $ValueName -Value $ValueData -Force \n}\n\ncatch {  \n    $ErrorMessage = $_.Exception.Message \n    Write-Warning $ErrorMessage\n    #Exit 1  \n}  \n</code></pre></p>"},{"location":"Intune/#azure-dynamic-groups","title":"Azure Dynamic Groups","text":"<p>To create a group that includes all your devices enrolled via Autopilot<pre><code>(device.devicePhysicalIDs -any (_ -contains \"[ZTDID]\"))\n</code></pre> To create a group for Windows Corporate devices enrolled via Autopilot<pre><code>(device.devicePhysicalIds -any _ -contains \u201c[ZTDId]\u201d) and (device.deviceOSType -contains \u201cWindows\u201d) and (device.deviceOwnership -contains \u201cCompany\u201d)\n</code></pre> Microsoft Defender Device Groups<pre><code>(device.managementType -eq \u201cMicrosoftSense\u201d)\n</code></pre> Microsoft Windows 10 devices<pre><code>(device.deviceOSVersion -startsWith \u201c10.0.1\u201d) -and (device.DeviceOSType -startsWith \u201cWindows\u201d)\n</code></pre></p>"},{"location":"Intune/#group-naming-conventions-ad-aad-365","title":"Group naming conventions (AD, AAD, 365)","text":"<p><pre><code>Distribution groups\nDL_&lt;COMPANYPREFIX&gt;_&lt;ROLE&gt;\n</code></pre> <pre><code>Security groups\nSG_AR_&lt;COMPANYPREFIX&gt;_&lt;OS&gt;_&lt;USER or DEVICES&gt;_&lt;ROLE&gt;\n</code></pre></p> <p>SG_AR_Company_Windows_Corp_Devices Toutes les machines corporate Windows</p> <p>AR_Company_MacOS_Corp_Devices Toutes les machines corporate MacOS</p> <p>AR_Company_WinServers_Devices Toutes les serveurs Windows</p> <p>AR_Company_LNX_Devices Toutes les serveurs Linux</p> <p>AR_Company_Apple_Corp_Devices Toutes les machines corporate Apple</p> <p>AR_Company_Android_Corp_Devices Toutes les machines corporate Android</p> <p>AR_Company_MacOS_Guest_Devices Toutes les machines guest MacOS</p> <p>AR_Company_Android_Guest_Devices Toutes les machines guest Android</p> <p>AR_Company_Windows_Guest_Devices Toutes les machines guest Windows</p> <p>AR_Company_MacOS_Guest_Devices Toutes les machines guest MacOS</p> <p>AR_Kyos_Guest_Users Tous les comptes invit\u00e9s du tenant</p>"},{"location":"Intune/#azure-local-users","title":"Azure Local users","text":""},{"location":"Intune/#oma-uri-1","title":"OMA-URI 1","text":"Local Admin<pre><code>Name - Local Admin\nDescription - Set Local Admin\nOMA-URI - ./Device/Vendor/MSFT/Accounts/Users/rahuljindallocaladmin/LocalUserGroup\nData Type - Interger\nValue - 2\n</code></pre>"},{"location":"Intune/#oma-uri-2","title":"OMA-URI 2","text":"Local Admin Password<pre><code>Name - Local Admin Password\nDescription - Set Local Admin Password\nOMA-URI - ./Device/Vendor/MSFT/Accounts/Users/rahuljindallocaladmin/Password\nData Type - String\nValue - P@55w0rd\n````\nhttps://rahuljindalmyit.blogspot.com/2021/05/intune-different-ways-of-setting-local.html\n\n## Device queries\nAll Company owned devices   (device.deviceOwnership -eq \u201cCompany\u201d)  \nAll personally owned devices    (device.deviceOwnership -eq \u201cPersonal\u201d) \nAll devices not managed by a MDM    (device.managementType -ne \u201cMDM\u201d)   \nAll devices managed by a MDM    (device.managementType -eq \u201cMDM\u201d)   \nAll devices managed by SCCM     (device.deviceManagementAppId -eq \u201c54b943f8-d761-4f8d-951e-9cea1846db5a\u201d)   \nAll devices managed by Intune   (device.deviceManagementAppId -eq \u201c0000000a-0000-0000-c000-000000000000\u201d)   \nAll devices from AD device.deviceTrustType -eq \u201cServerAd\u201d   \nAll devices from Azure AD   (device.deviceTrustType -eq \u201cAzureAd\u201d)  \nAll devices not joined to AAD or AD (device.deviceTrustType -eq \u201cWorkplace\u201d)    \n\n## Windows      \nAll Windows Devices (device.deviceOSType -match \u201cWindows\u201d)  \nAll company owned Windows devices   (device.deviceOSType -eq \u201cWindows\u201d) -and (device.deviceOwnership -eq \u201cCompany\u201d) \nAll personally owned Windows devices    (device.deviceOSType -eq \u201cWindows\u201d) -and (device.deviceOwnership -eq \u201cPersonal\u201d)    \nAll Windows virtual machines    (device.deviceModel -eq \u201cVirtual Machine\u201d)  \n\n## Android      \nAll Android devices (device.deviceOSType -match \u201cAndroid\u201d)  \nAll company owned Android devices   (device.deviceOSType -eq \u201cAndroid\u201d) -and (device.deviceOwnership -eq \u201cCompany\u201d) \nAll personally owned Android devices    (device.deviceOSType -eq \u201cWindows\u201d) -and (device.deviceOwnership -eq \u201cPersonal\u201d)    \nAll Android Enterprise devices  (device.deviceOSType -match \u201cAndroidEnterprise\u201d)    \nAll company owned Android Enterprise devices    (device.deviceOSType -eq \u201cAndroidEnterprise\u201d) -and (device.deviceOwnership -eq \u201cCompany\u201d)   \nAll Android devices enrolled with a specific profile name   (device.enrollmentProfileName -contains \u201cDedicated\u201d)    Update the rule with the same name you gave your enrollment profile\n\n## iOS      \nAll iPads devices   (device.deviceOSType -eq \u201ciPad\u201d)    \nAll personally owned iPad devices   (device.deviceOSType -eq \u201ciPad\u201d) -and (device.deviceOwnership -eq \u201cPersonal\u201d)   \nAll Company owned iPad devices  (device.deviceOSType -eq \u201ciPad\u201d) -and (device.deviceOwnership -eq \u201cCompany\u201d)    \nAll iPhones devices (device.deviceOSType -eq \u201cIPhone\u201d)  \nAll personally owned iPhone devices (device.deviceOSType -eq \u201cIPhone\u201d) -and (device.deviceOwnership -eq \u201cPersonal\u201d) \nAll Company owned iPhone devices    (device.deviceOSType -eq \u201cIPhone\u201d) -and (device.deviceOwnership -eq \u201cCompany\u201d)  \n\n## macOS        \nAll Mac devices (device.deviceOSType -eq \u201cMacMDM\u201d)  \nAll Company owned Mac devices   (device.deviceOSType -eq \u201cMacMDM\u201d) -and (device.deviceOwnership -eq \u201cCompany\u201d)  \n\n## Device Queries for Autopilot\nAll Autopilot registered devices    (device.devicePhysicalIDs -any _ -contains \u201c[ZTDId]\u201d)   \nA specific device thats autopilot registered    (device.devicePhysicalIDs -contains \u201c[ZTDId]:6598-3522-5834-2658-4381-8581-32\u201d) If you want to create a dynamic group only containing one specific device you can specify the ZTDid for that device.\nAutopilot devices with a specific OrderID (Group Tag)   (device.devicePhysicalIds -any _ -eq \u201c[OrderID]:SelfDeploying\u201d) \nAutopilot devices that have been enrolled using a specific enrollment profile   (device.enrollmentProfileName -eq \u201cAPHybridJoin\u201d)   Name of the Autopilot enrollment profile.\n\n## User queries\nAll Users with EMS assigned and enabled user.assignedPlans -any (assignedPlan.service -eq \u201cSCO\u201d -and assignedPlan.capabilityStatus -eq \u201cEnabled\u201d)   \nAll users with an AAD enabled account   (user.accountEnabled -eq True)  \nAll users with an email that contains .com  (user.mail -contains \u201c.com\u201d)    \nAll Users with a Intune license thats not disabled.     USER.ASSIGNEDPLANS -ANY (ASSIGNEDPLAN.SERVICEPLANID -EQ \u201cc1ec4a95-1f05-45b3-a911-aa3fa01094f5\u201d -and assignedPlan.capabilityStatus -ne \u201cDisabled\u201d)   \nAll users with Yammer Enterprise license assigned and enabled.  user.assignedPlans -any (assignedPlan.service -eq \u201cYammerEnterprise\u201d -and assignedPlan.capabilityStatus -eq \u201cEnabled\u201d)  \nAll users with MicrosoftPrint license assigned and enabled.     user.assignedPlans -any (assignedPlan.service -eq \u201cMicrosoftPrint\u201d -and assignedPlan.capabilityStatus -eq \u201cEnabled\u201d)    \nAll guest users in AAD  (user.userType -eq \u201cGuest\u201d) Users created in AAD or AD are \u201cMembers\u201d and all users you invited in to your tenant are labeled as \u201cGuest\u201d \n</code></pre>"},{"location":"Intune/#update-intune-connector","title":"Update Intune connector","text":"<p>Get the PowerShell script here: https://github.com/stevecapacity/IntunePowershell/blob/main/HybridConnectorFixer.ps1 Video: https://www.youtube.com/watch?v=cZZ0O1vn2do&amp;t=163s https://techcommunity.microsoft.com/blog/intunecustomersuccess/microsoft-intune-connector-for-active-directory-security-update/4386898</p> <p>Hybride </p>"},{"location":"Intune/#voici-comment-donner-ces-permissions-etape-par-etape","title":"Voici comment donner ces permissions \u00e9tape par \u00e9tape :","text":""},{"location":"Intune/#1-creer-lou-dediee","title":"1. Cr\u00e9er l'OU d\u00e9di\u00e9e","text":"<p>Dans Active Directory Users and Computers :</p> <ol> <li>Clic droit sur votre domaine \u2192 New \u2192 Organizational Unit</li> <li>Nommez-la <code>Intune Hybrid Devices</code></li> <li>D\u00e9cochez \"Protect container from accidental deletion\" si n\u00e9cessaire</li> </ol>"},{"location":"Intune/#2-deleguer-les-permissions-sur-lou","title":"2. D\u00e9l\u00e9guer les permissions sur l'OU","text":"<p>M\u00e9thode 1 : Assistant de d\u00e9l\u00e9gation (Recommand\u00e9e)</p> <ol> <li>Clic droit sur l'OU \"Intune Hybrid Devices\" \u2192 Delegate Control...</li> <li>Dans l'assistant :</li> <li>Next \u2192 Add \u2192 Saisissez le nom du Managed Service Account (MSA) cr\u00e9\u00e9 par le connecteur</li> <li>Ou ajoutez le groupe Domain Computers temporairement</li> <li>S\u00e9lectionnez les t\u00e2ches \u00e0 d\u00e9l\u00e9guer :</li> <li>\u2611\ufe0f Create, delete, and manage computer accounts</li> <li>\u2611\ufe0f Reset user passwords and force password change at next logon</li> <li>\u2611\ufe0f Read all user information</li> <li>\u2611\ufe0f Modify the membership of a group</li> </ol> <p>M\u00e9thode 2 : Permissions avanc\u00e9es (Plus pr\u00e9cise)</p> <ol> <li>Clic droit sur l'OU \u2192 Properties \u2192 Security \u2192 Advanced</li> <li>Add \u2192 Saisissez le compte MSA ou le compte de service</li> <li>Permissions d\u00e9taill\u00e9es \u00e0 cocher :</li> </ol> <pre><code>Type: Allow\nApplies to: This object and all descendant objects\n\nPermissions sp\u00e9cifiques :\n\u2611\ufe0f Create Computer objects\n\u2611\ufe0f Delete Computer objects  \n\u2611\ufe0f Write all properties\n\u2611\ufe0f Read all properties\n\u2611\ufe0f Reset password\n\u2611\ufe0f Change password\n\u2611\ufe0f Validated write to DNS host name\n\u2611\ufe0f Validated write to service principal name\n</code></pre>"},{"location":"Intune/#3-permissions-sur-le-conteneur-managed-service-accounts","title":"3. Permissions sur le conteneur Managed Service Accounts","text":"<p>Dans Active Directory Users and Computers :</p> <ol> <li>View \u2192 Cochez Advanced Features (pour voir les conteneurs syst\u00e8me)</li> <li>Naviguez vers Domain \u2192 System \u2192 Managed Service Accounts</li> <li>Clic droit sur Managed Service Accounts \u2192 Properties \u2192 Security</li> <li>Add \u2192 Ajoutez le compte qui installe le connecteur</li> <li>Permissions \u00e0 donner :</li> <li>\u2611\ufe0f Create msDs-ManagedServiceAccount objects</li> <li>\u2611\ufe0f Read</li> <li>\u2611\ufe0f Write</li> </ol>"},{"location":"Intune/#4-verifier-avec-powershell-optionnel","title":"4. V\u00e9rifier avec PowerShell (Optionnel)","text":"<pre><code># V\u00e9rifier les permissions sur l'OU\nGet-Acl \"AD:\\OU=Intune Hybrid Devices,DC=votre-domaine,DC=com\" | Format-List\n\n# V\u00e9rifier le MSA cr\u00e9\u00e9\nGet-ADServiceAccount -Filter * | Where-Object {$_.Name -like \"*Intune*\"}\n</code></pre>"},{"location":"Intune/#5-configuration-dans-le-connecteur-intune","title":"5. Configuration dans le connecteur Intune","text":"<ol> <li>Ouvrez l'application \"Intune Connector for Active Directory\"</li> <li>Configure \u2192 Sp\u00e9cifiez l'OU cible : <code>OU=Intune Hybrid Devices,DC=votre-domaine,DC=com</code></li> <li>Test la connexion et les permissions</li> </ol>"},{"location":"Intune/#6-configuration-dans-le-portail-intune","title":"6. Configuration dans le portail Intune","text":"<ol> <li>Microsoft Intune admin center \u2192 Devices \u2192 Windows enrollment</li> <li>Windows Autopilot deployment profiles \u2192 Cr\u00e9ez ou modifiez un profil</li> <li>Dans Out-of-box experience (OOBE) \u2192 Sp\u00e9cifiez l'OU cible</li> </ol>"},{"location":"Intune/#points-importants","title":"Points importants :","text":"<ul> <li>Le nom exact du MSA sera visible dans l'application du connecteur apr\u00e8s installation</li> <li>Si vous ne trouvez pas le MSA, utilisez temporairement un compte de service d\u00e9di\u00e9</li> <li>Testez toujours avec un appareil de test avant le d\u00e9ploiement en production</li> <li>Les permissions peuvent prendre quelques minutes \u00e0 se propager dans AD</li> </ul> <p>Cette configuration permettra au connecteur de cr\u00e9er et g\u00e9rer les comptes d'ordinateurs dans l'OU d\u00e9di\u00e9e en toute s\u00e9curit\u00e9.</p>"},{"location":"MDE/","title":"Microsft Defender for Endpoints","text":"<p>Make sure \"Turn Off Microsoft Defender\" Policy is not activated (its a GPO). It should be set to NOT configured or Disabled</p>"},{"location":"MDE/#phases-de-deploiements","title":"Phases de deploiements:","text":"<p>\u00c9tape 1 : Configurer Microsoft Defender pour point de terminaison d\u00e9ploiement : cette \u00e9tape se concentre sur la pr\u00e9paration de votre environnement pour le d\u00e9ploiement.: - V\u00e9rifier l\u2019\u00e9tat de la licence - Emplacement du centre de donn\u00e9es - Configuration r\u00e9seau</p> <p>\u00c9tape 2 : Attribuer des r\u00f4les et des autorisations : identifiez et attribuez des r\u00f4les et des autorisations pour afficher et g\u00e9rer Defender pour point de terminaison.</p> <p>\u00c9tape 3 - Configurer les fonctionnalit\u00e9s : Vous \u00eates maintenant pr\u00eat \u00e0 configurer les fonctionnalit\u00e9s de s\u00e9curit\u00e9 de Defender pour point de terminaison pour prot\u00e9ger vos appareils.</p> <p>\u00c9tape 4 : Identifier votre architecture et choisir votre m\u00e9thode de d\u00e9ploiement : identifiez votre architecture et la m\u00e9thode de d\u00e9ploiement qui convient le mieux \u00e0 votre organization.</p> <p>\u00c9tape 5 - Int\u00e9grer des appareils : \u00e9valuez et int\u00e9grez vos appareils \u00e0 Defender pour point de terminaison: - \u00c9valuation: identifiez 50 appareils \u00e0 int\u00e9grer au service \u00e0 des fins de test. - Pilote: int\u00e9grez les 50 \u00e0 100 points de terminaison suivants dans un environnement de production. - Ex\u00e9cuter une simulation: https://learn.microsoft.com/fr-fr/microsoft-365/security/defender-endpoint/attack-simulations?view=o365-worldwide#run-a-simulation - D\u00e9ploiement complet: d\u00e9ployer le service dans le reste de l\u2019environnement par incr\u00e9ments plus importants</p>"},{"location":"MDE/#pre-requists","title":"Pre-requists","text":"<p>Run the client analyzer on Windows</p> <p>Direct connection Proxy: - Unauthenticated - No TLS inspection</p> <p>crl.microsoft.com ctldl.microsoft.com crl.microsoft.com www.microsoft.com/pkiops/ www.microsoft.com/pki/ uk-v20.events.data.microsoft.com or *.events.data.microsoft.com</p>"},{"location":"MDE/#add-microsoft-defender-for-endpoint-to-the-exclusion-list-for-your-existing-solution","title":"Add Microsoft Defender for Endpoint to the exclusion list for your existing solution","text":"Windows 11 exclusions<pre><code>C:\\Program Files\\Windows Defender Advanced Threat Protection\\MsSense.exe\nC:\\Program Files\\Windows Defender Advanced Threat Protection\\SenseCncProxy.exe\nC:\\Program Files\\Windows Defender Advanced Threat Protection\\SenseSampleUploader.exe\nC:\\Program Files\\Windows Defender Advanced Threat Protection\\SenseIR.exe\nC:\\Program Files\\Windows Defender Advanced Threat Protection\\SenseCM.exe\nC:\\Program Files\\Windows Defender Advanced Threat Protection\\SenseNdr.exe\nC:\\Program Files\\Windows Defender Advanced Threat Protection\\SenseSC.exe\nC:\\Program Files\\Windows Defender Advanced Threat Protection\\Classification\\SenseCE.exe\nC:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\DataCollection\nC:\\Program Files\\Windows Defender Advanced Threat Protection\\SenseTVM.exe\n</code></pre> Windows Servers 2012R2, 2016, 2019, 2022 exclusions<pre><code>C:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Platform\\*\\MsSense.exe\nC:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Platform\\*\\SenseCnCProxy.exe\nC:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Platform\\*\\SenseIR.exe\nC:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Platform\\*\\SenseCE.exe\nC:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Platform\\*\\SenseSampleUploader.exe\nC:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Platform\\*\\SenseCM.exe\nC:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\DataCollection\nC:\\ProgramData\\Microsoft\\Windows Defender Advanced Threat Protection\\Platform\\*\\SenseTVM.exe\n</code></pre>"},{"location":"MDE/#check-if-the-device-has-already-been-onboarded","title":"Check if the device has already been onboarded","text":"<p>Check if \"Computer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows Advanced Threat Protection\" has subfolders </p>"},{"location":"MDE/#install-the-windows-defender-for-endpoint-msi","title":"Install the Windows Defender for Endpoint msi","text":""},{"location":"MDE/#with-gpo","title":"with GPO.","text":"<p>under Delegation &gt; Advanced &gt; - Remove Authenticated users group - Add the group contenning the servers wanted &gt; and give XXX group READ and APPLY GROUP POLICY permission</p>"},{"location":"MDE/#for-windows-server-2012-and-2016","title":"For Windows server 2012 and 2016","text":"<ol> <li> <p>Download MDE installation packet (md4ws.msi) and onboarding script from Microsoft Security portal MDE installation packet</p> </li> <li> <p>Download Microsoft helper script</p> </li> <li> <p>Download latest MDE platform update</p> </li> <li> <p>Run helper script to onboard <pre><code>.\\Install.ps1 -UI -OnboardingScript \".\\WindowsDefenderATPOnboardingScript.cmd\"\n</code></pre></p> </li> </ol> <p>Pour le script onboarding il faut prendre la version pour les GPO car elle n'est pas interactive</p>"},{"location":"MDE/#disable-ms-defender-service","title":"Disable MS Defender service","text":"<p>La d\u00e9sactivation de Windows Defender 2021 peut \u00eatre effectu\u00e9e en utilisant l\u2019invite de commande (CMD).  sc config WinDefend start=disabled</p>"},{"location":"MDE/#disable-ms-defender-par-gpo","title":"Disable MS Defender par GPO","text":"<p>Browse the following path: Computer Configuration &gt; Administrative Templates &gt; Windows Components &gt; Microsoft Defender Antivirus Double-click the \"Turn off Microsoft Defender Antivirus\" policy. </p>"},{"location":"MDE/#add-mde-tags-on-devices-through-gpo","title":"Add MDE tags on devices through GPO","text":"<p>Registry key : Computer\\HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Advanced Threat Protection\\DeviceTagging Registry key value (REG_SZ) : Group Registry key data : Servers</p>"},{"location":"MDE/#get-exclusions","title":"Get Exclusions","text":"<pre><code>function Get-Exclusions {\n    $Prefs = Get-MpPreference\n    $Prefs.ExclusionExtension | ForEach-Object { [PSCustomObject]@{ Item = $_; Type = \"Extension\" } }\n    $Prefs.ExclusionProcess | ForEach-Object { [PSCustomObject]@{ Item = $_; Type = \"Process\" } }\n    $Prefs.ExclusionPath | ForEach-Object { [PSCustomObject]@{ Item = $_; Type = \"Path\" } }\n    $Prefs.ExclusionIpAddress | ForEach-Object { [PSCustomObject]@{ Item = $_; Type = \"IpAddress\" } }\n}\n\nGet-Exclusions | ConvertTo-Csv -NoTypeInformation\n</code></pre>"},{"location":"MDE/#get-asr-status","title":"Get ASR Status","text":"<pre><code>&lt;#\n    Outputs Attack Surface Reduction rule status\n#&gt;\n\nfunction Get-AttackSurfaceReductionRuleStatus {\n\n    function Get-AsrStatus ($Value) {\n        switch ($Value) {\n            0 { \"Disabled\" }\n            1 { \"Enabled\" }\n            2 { \"Audit\" }\n            default { \"Not configured\" }\n        }\n    }\n\n    $Prefs = Get-MpPreference\n    if ($null -eq $Prefs.AttackSurfaceReductionRules_Ids) {\n        Write-Host \"ASR rules not configured.\"\n    }\n    else {\n        for ($i = 0; $i -le ($Prefs.AttackSurfaceReductionRules_Ids.Count - 1); $i++) {\n            [PSCustomObject]@{\n                RuleId = $Prefs.AttackSurfaceReductionRules_Ids[$i]\n                Status = Get-AsrStatus -Value $Prefs.AttackSurfaceReductionRules_Actions[$i]\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"MDE/#check-if-defender-edr-is-activated","title":"Check if Defender EDR is activated","text":""},{"location":"MDE/#on-servers-sense-must-be-started","title":"On servers SENSE must be started","text":"<p>When the SENSE service starts for the first time, it writes onboarding status to the registry location <pre><code>HKLM\\SOFTWARE\\Microsoft\\Windows Advanced Threat Protection\\Status\nSENSE service onboarding status isn't set to 1\n</code></pre> Source: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/troubleshoot-onboarding?view=o365-worldwide</p>"},{"location":"MDE/#verify-client-connectivity-to-microsoft-defender-for-endpoint-service-urls","title":"Verify client connectivity to Microsoft Defender for Endpoint service URLs","text":"<p>https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/configure-proxy-internet?view=o365-worldwide#verify-client-connectivity-to-microsoft-defender-for-endpoint-service-urls</p>"},{"location":"MDE/#mde-commands","title":"MDE commands","text":"MDE change comands<pre><code>Set-MpPreference -DisableRealtimeMonitoring $false\nSet-MpPreference -DisableIOAVProtection $false\nNew-Item -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\" -Name \"Real-Time Protection\" -Force\nNew-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" -Name \"DisableBehaviorMonitoring\" -Value 0 -PropertyType DWORD -Force\nNew-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" -Name \"DisableOnAccessProtection\" -Value 0 -PropertyType DWORD -Force\nNew-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection\" -Name \"DisableScanOnRealtimeEnable\" -Value 0 -PropertyType DWORD -Force\nNew-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\" -Name \"DisableAntiSpyware\" -Value 0 -PropertyType DWORD -Force\nstart-service WinDefend\nstart-service WdNisSvc\n\nNew-Item -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\" -Name \"DisableAntiSpyware\" -Force -Value 1 -PropertyType DWORD -Force\nNew-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\DisableAntiSpyware\" -Name \"DisableBehaviorMonitoring\" -Value 0 -PropertyType DWORD -Force\n\nRemove-ItemProperty -Path \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\" -Name \"DisableAntiSpyware\" -Force\n</code></pre> MDE PowerShell Commands:<pre><code>get-mpcomputerstatus\nget-mpthreat\nget-mpthreatdetection\nSet-MpPreference -DisableRealtimeMonitoring $true\nAdd-MpPreference -ExclusionPath \"c:\\ADAMDEMO\"\nUpdate-mpsignature\nStart-mpscan \n</code></pre> To quickly check if the Windows Defender is enabled on your computer and find out when the antivirus definition was last updated:<pre><code>Get-MpComputerStatus | Select-Object -Property Antivirusenabled,AMServiceEnabled,AntispywareEnabled,BehaviorMonitorEnabled,IoavProtectionEnabled,NISEnabled,OnAccessProtectionEnabled,RealTimeProtectionEnabled,IsTamperProtected,AntivirusSignatureLastUpdated\n</code></pre>"},{"location":"MDE/#arreter-les-scan-mde-defender","title":"Arreter les Scan MDE Defender","text":"<ol> <li>Passer le serveur en mode TroubleShoot</li> <li>D\u00e9sactiver le Tamper Protection D\u00e9sactiver le Tamper Protection sur la machine<pre><code>PS C:\\Users\\admjpm&gt; Set-MpPreference -DisableTamperProtection $true\n</code></pre></li> <li>Arreter les scans arreter les scans<pre><code>PS C:\\Users\\admjpm&gt; cd \"C:\\Program Files\\Windows Defender\"\nPS C:\\Program Files\\Windows Defender&gt; .\\MpCmdRun.exe -scan -cancel\nArgument -cancel detected. Trying to cancel any quick/full scan in progress...\nScan cancelled successfully.\n</code></pre></li> </ol>"},{"location":"MSExchange/","title":"MSExchange","text":""},{"location":"MSExchange/#run-a-health-check-script","title":"Run a health check script","text":"<p>Run the Exchange HealthChecker script (https://microsoft.github.io/CSS-Exchange/Diagnostics/HealthChecker/) , and check the build number.</p>"},{"location":"MSExchange/#find-exchange-version-with-powershell","title":"Find Exchange version with PowerShell","text":"<p>We are going to use the Get-ExchangeServer cmdlet.<pre><code>Get-ExchangeServer | Format-List Name, Edition, AdminDisplayVersion\n</code></pre> Find Exchange version with PowerShell including Security Update<pre><code>$ExchangeServers = Get-ExchangeServer | Sort-Object Name\nForEach ($Server in $ExchangeServers) {\n    Invoke-Command -ComputerName $Server.Name -ScriptBlock { Get-Command Exsetup.exe | ForEach-Object { $_.FileversionInfo } }\n}\n</code></pre></p>"},{"location":"MSExchange/#find-exchange-product-name-from-build-number","title":"Find Exchange Product name from Build number","text":"<p>Go to the Microsoft Docs (https://learn.microsoft.com/en-us/exchange/new-features/build-numbers-and-release-dates?view=exchserver-2019) page and check the Product name</p>"},{"location":"MSPortals/","title":"MSPortals","text":""},{"location":"MSPortals/#msportalsio","title":"MSportals.io","text":"<p>Microsoft 365 Admin Portals Microsoft 365 Admin Center : https://admin.microsoft.com Microsoft 365 Apps Admin Center: https://config.office.com Exchange Admin Center (EAC) New: https://admin.exchange.microsoft.com Exchange Admin Center (EAC) Old: https://outlook.office365.com/ecp/</p> <p>Microsoft Purview Microsoft 365 Compliance: https://compliance.microsoft.com \u2002\u2022 B2B\u2009 Microsoft 365 network connectivity test: https://connectivity.office.com Microsoft 365 Network Insights Preview: https://portal.office.com/adminportal/home#/networkperformance Microsoft Call Quality Dashboard (Teams) https://cqd.teams.microsoft.com Microsoft Call Quality Dashboard (Lync) https://cqd.lync.com Microsoft Intune Admin Center Endpoint Manager: https://intune.microsoft.com \u2002\u2022 aka.ms\u2009Old \ud83d\udd17\u2009B2B\u2009 Microsoft Endpoint Manager Admin Console Release Candidate https://rc-devicemanagement.portal.azure.com Microsoft Endpoint Manager Admin Console Old https://devicemanagement.portal.azure.com Microsoft Intune for Education https://intuneeducation.portal.azure.com Microsoft Online https://portal.microsoftonline.com/IWDefault.aspx Microsoft Store for Business https://businessstore.microsoft.com Microsoft Store for Education https://educationstore.microsoft.com Microsoft Stream Admin Center https://web.microsoftstream.com/admin Microsoft Purview Azure and Fabric Governance https://web.purview.azure.com/ Microsoft Purview Preview Azure and Fabric Governance https://purview.microsoft.com/ Microsoft Teams Admin Center https://admin.teams.microsoft.com \u2002\u2022 aka.ms\u2009 Teams Rooms Pro Management portal https://portal.rooms.microsoft.com/ My Staff (preview) https://mystaff.microsoft.com \u2002\u2022 aka.ms\u2009 Power Apps ISV Studio https://isvstudio.powerapps.com/home \u2002\u2022 aka.ms\u2009 Power Apps Maker Portal https://make.powerapps.com Power Automate Maker Portal Microsoft Flow https://make.powerautomate.com \u2002\u2022 Old \ud83d\udd17\u2009 Power BI Admin Portal https://app.powerbi.com/admin-portal/usageMetrics?noSignUpCheck=1 Power Pages Preview https://make.powerpages.microsoft.com/ Power Platform admin center https://admin.powerplatform.microsoft.com \u2002\u2022 aka.ms\u2009 Power Virtual Agents Portal https://powerva.microsoft.com Phone Number Service Center https://pstnsd.powerappsportals.com/ SharePoint Admin Center https://admin.microsoft.com/sharepoint SharePoint look book https://lookbook.microsoft.com/ Skype for Business admin center Deprecated https://webdir2a.online.lync.com/LSCP Yammer Admin https://www.yammer.com/office365/admin My Applications (My Apps) https://myapplications.microsoft.com/ My Access (Access Packages) https://myaccess.microsoft.com/ \u2002\u2022 B2B\u2009 Azure IT Admin Portals Microsoft Azure Portal https://portal.azure.com \u2002\u2022 aka.ms\u2009B2B\u2009 Microsoft Azure Release Candidate https://rc.portal.azure.com Microsoft Azure Preview https://preview.portal.azure.com Microsoft Entra Admin Center (Formerly Azure AD Admin Center) Identity Management https://entra.microsoft.com \u2002\u2022 aka.ms\u2009B2B\u2009 Create New Tenant / Azure Active Directory https://account.azure.com/organization Azure Cloud Shell https://shell.azure.com Azure Cosmos DB https://cosmos.azure.com Azure Data Factory https://adf.azure.com Azure Synapse Analytics https://web.azuresynapse.net/ Azure Non-profit Portal https://nonprofit.microsoft.com Azure Resource Explorer https://resources.azure.com Azure Resource Explorer Raw https://resources.azure.com/raw Azure IT Admin Portals - Sub Portal Links Azure Authentication methods https://aad.portal.azure.com/#blade/Microsoft_AAD_IAM/AuthenticationMethodsMenuBlade/AdminAuthMethods/ Azure Backup Center https://portal.azure.com/#blade/Microsoft_Azure_DataProtection/BackupCenterMenuBlade/overview Privileged Identity Management https://portal.azure.com/#blade/Microsoft_Azure_PIMCommon/CommonMenuBlade/quickStart \u2002\u2022 aka.ms\u2009 Desktop Analytics Portal https://devicemanagement.portal.azure.com/#blade/Microsoft_M365_ManageClient/ManageClientFrameBlade Azure Sentinel https://portal.azure.com/#blade/Microsoft_Azure_Security_Insights/WorkspaceSelectorBlade Azure Universal Print Raw https://portal.azure.com/#blade/Universal_Print/MainMenuBlade/Overview Azure AI / ML Portals Azure AI Studio Preview https://ai.azure.com Azure Machine Learning Studio https://ml.azure.com Bot Framework Dev Portal https://dev.botframework.com Custom Translator https://portal.customtranslator.azure.ai/ Custom Vision https://www.customvision.ai/ Vision Studio Preview https://preview.vision.azure.com/ Speech Studio https://speech.microsoft.com/ Language Studio https://language.azure.com/ LUIS Portal https://www.luis.ai/ QnA Maker Portal https://www.qnamaker.ai/ Video Indexer https://www.videoindexer.ai/ Azure Graph Explorer Deprecated https://graphexplorer.azurewebsites.net/# Azure OpenAI service https://oai.azure.com/portal Microsoft Licensing/Support Portals Azure Subscriptions https://account.azure.com/Subscriptions Azure New Support Request https://portal.azure.com/#create/Microsoft.Support Microsoft Azure Enterprise Portal https://ea.azure.com Microsoft FastTrack Includes App Assure https://fasttrack.microsoft.com Microsoft License Advisor https://mla.microsoft.com Microsoft Partner Center https://partner.microsoft.com Microsoft Services Hub https://serviceshub.microsoft.com Microsoft Volume Licensing eAgreements https://eagreements.microsoft.com/ Next Generation Volume Licensing https://businessaccount.microsoft.com Volume Licensing Service Center https://www.microsoft.com/Licensing/servicecenter/ Microsoft Defender / Security IT Admin Portals Microsoft Security Copilot https://securitycopilot.microsoft.com/ Microsoft Defender Threat Intelligence https://ti.defender.microsoft.com/ Microsoft 365 Defender Previously Microsoft 365 security https://security.microsoft.com \u2002\u2022 B2B\u2009aka.ms\u2009 Microsoft Defender for Cloud Apps (MDA) Previously Microsoft Cloud App Security (MCAS) https://portal.cloudappsecurity.com \u2002\u2022 aka.ms\u2009 Microsoft Defender for Endpoints (MDE) Deprecated: Previously Defender ATP https://securitycenter.windows.com \u2002\u2022 aka.ms\u2009 Microsoft Defender for Identity (MDI) Deprecated: Previously Azure ATP https://portal.atp.azure.com \u2002\u2022 aka.ms\u2009 Microsoft Defender for Internet of Things (IoT) https://portal.azure.com/#blade/Microsoft_Azure_IoT_Defender/IoTDefenderDashboard Microsoft Defender ATP Testground Being deprecated 09/30/2022 https://demo.wd.microsoft.com/ Attack simulation training sub-portal https://security.microsoft.com/attacksimulator \u2002\u2022 aka.ms\u2009 Microsoft Defender for Cloud (MDC) Azure Security Center (ASC) https://portal.azure.com/#blade/Microsoft_Azure_Security/SecurityMenuBlade/0 Microsoft Secure Score https://security.microsoft.com/securescore Microsoft Security Intelligence https://microsoft.com/wdsi Multi-factor authentication (MFA) https://account.activedirectory.windowsazure.com/usermanagement/multifactorverification.aspx CloudKnox Permissions Management https://c1.app.mciem.cloudknox.io Microsoft AccountGuard https://accountguard.microsoft.com Office 365 Security &amp; Compliance Deprecated https://protection.office.com Report an unsafe site (login) https://www.microsoft.com/en-us/wdsi/support/report-unsafe-site Report an unsafe site (guest) https://www.microsoft.com/en-us/wdsi/support/report-unsafe-site-guest Submit a file for malware analysis https://www.microsoft.com/en-us/wdsi/filesubmission Submit Vulnerability https://msrc.microsoft.com/report/vulnerability Reporting Infringement or DCMA Notice to Microsoft https://www.microsoft.com/en-us/legal/intellectualproperty/infringement Reporting Issue with Bingbot https://www.microsoft.com/en-us/legal/intellectualproperty/infringement Submit Abuse Report (CERT) https://msrc.microsoft.com/report/abuse Developer Portals Copilot Studio https://copilotstudio.microsoft.com/ Microsoft Fabric https://fabric.microsoft.com/ Actionable Messages Developer Dashboard https://outlook.office.com/connectors/oam/publish \u2002\u2022 aka.ms\u2009 Actionable Message Designer https://amdesigner.azurewebsites.net/ Adaptive Cards Designer https://adaptivecards.io/designer/ Applied AI Form Recognizer Studio - Preview https://formrecognizer.appliedai.azure.com Azure Data Explorer https://dataexplorer.azure.com/ \u2002\u2022 aka.ms\u2009 Azure DevOps https://aex.dev.azure.com/me \u2002\u2022 B2B\u2009 Bing Maps Portal https://www.bingmapsportal.com/ Microsoft Graph Explorer https://developer.microsoft.com/en-us/graph/graph-explorer \u2002\u2022 aka.ms\u2009B2B\u2009 JWT/MS Token Decoder https://jwt.ms/ Message Card Playground New Tool - Actionable Message Designer https://messagecardplayground.azurewebsites.net/ Microsoft Graph Toolkit https://mgt.dev/ Visual Studio (VS) Code in the Web https://www.vscode.dev/ Visual Studio (VS) Code in the Web Insiders Version https://insiders.vscode.dev/ Microsoft Online Error Code Lookup https://login.microsoftonline.com/error Microsoft AppSource https://appsource.microsoft.com/ Visual Studio Subscriptions https://my.visualstudio.com Visual Studio Subscriptions Management https://manage.visualstudio.com Microsoft Clarity (HeatMaps &amp; Sessions Recordings) https://clarity.microsoft.com/ Bing WebMaster Tools https://www.bing.com/webmasters Developer Portal for Teams https://dev.teams.microsoft.com Microsoft 365 Developer Program Dashboard https://developer.microsoft.com/microsoft-365/profile Health / Status Portals Microsoft Service health status Microsoft 365, Azure, Power Platform https://status.office.com/ Microsoft 365 Service health status https://portal.office.com/ServiceStatus Microsoft 365 Service health status (Admin portal) https://admin.microsoft.com/AdminPortal/Home#/servicehealth Azure DevOps - Status https://status.dev.azure.com Azure Service Health -&gt; Service issues https://portal.azure.com/?source=akams%2F#blade/Microsoft_Azure_Health/AzureHealthBrowseBlade/serviceIssues \u2002\u2022 aka.ms\u2009 Azure - Status https://status.azure.com/status/ Windows release health https://learn.microsoft.com/windows/release-health/ Twitter - Microsoft 365 Status Page https://twitter.com/MSFT365Status Microsoft Trials Microsoft Defender for Identity Trial -3-month https://signup.microsoft.com/Signup?OfferId=a0db242a-96d7-4f99-bd52-05c0d5556257&amp;ali=1 Microsoft Defender for Office 365 (Plan 2) 90 Day, Full Tenant Trial https://signup.microsoft.com/signup/logout?OfferId=20298c4d-d500-47fa-b3cd-a3f7d75d9253 Microsoft Defender for Endpoint P2 Trial - 3-month https://signup.microsoft.com/create-account/signup?products=7f379fee-c4f9-4278-b0a1-e4c8c2fcdf7e&amp;ru=https://aka.ms/MDEp2OpenTrial Microsoft 365 E5 Security Trial - 1-month https://signup.microsoft.com/Signup?OfferId=b73fce33-ac89-4175-b199-0173b4c74b1f&amp;ali=1 Microsoft Defender for Identity Trial - 3-month https://signup.microsoft.com/Signup?OfferId=a0db242a-96d7-4f99-bd52-05c0d5556257&amp;ali=1 App governance add-on to Microsoft Defender for Cloud Apps Trial - 90-day https://signup.microsoft.com/get-started/signup?products=a52e9277-0d85-4480-8cae-a84bc2ab32ae&amp;culture=en-us&amp;country=US&amp;ali=1 Microsoft 365 Defender portal trials hub https://security.microsoft.com/trialHorizontalHub?sku=MDO&amp;ref=DocsRef Microsoft Purview compliance portal trials hub https://compliance.microsoft.com/trialHorizontalHub?sku=ComplianceE5&amp;ref=DocsRef Microsoft 365 E5 Insider Risk Management Trial https://signup.microsoft.com/signup?OfferId=7B74C69A-2BFC-41C9-AAF1-23070354622D Microsoft 365 E5 Information Protection and Governance Trial https://signup.microsoft.com/signup?OfferId=503D4D1D-0169-4E1F-AE26-DB041C54C5C4 Microsoft 365 E5 Compliance Trial https://signup.microsoft.com/Signup?OfferId=d53d8416-fd1f-4552-831c-b5828ef2cbde&amp;ali=1 Compliance Manager Premium Assessment Add-On Trial - 90-day https://signup.microsoft.com/get-started/signup?products=e320704d-b7c9-4012-b6a6-0a2679790360&amp;culture=en-us&amp;country=US&amp;ali=1 Microsoft 365 E5 eDiscovery and Audit Trial https://signup.microsoft.com/signup?OfferId=c6ca396f-4467-4761-95f6-b6d9a5386716 Privacy Management - subject rights request (50) Trial - 90-day https://signup.microsoft.com/get-started/signup?products=1c6c565d-cae2-4648-aa92-bf52b523fdbd&amp;ali=1 Priva Privacy Risk Management Trial - 90-day https://signup.microsoft.com/get-started/signup?products=e6b633e0-1b1e-4d95-b414-3ce9e8023c39 Sign-up for Office 365 E3, 25 licenses trial, 30-day https://signup.microsoft.com/get-started/signup?OfferId=B07A1127-DE83-4a6d-9F85-2C104BDAE8B4&amp;dl=ENTERPRISEPACK&amp;ali=1&amp;products=cfq7ttc0k59j%3a0009&amp;bac=1 Microsoft 365 Business Premium Trial, 1 Month https://signup.microsoft.com/get-started/signup?products=53e11149-82f9-4bca-a7f2-8f72592e4f03&amp;mproducts=CFQ7TTC0LCHC:0003&amp;fmproducts=CFQ7TTC0LCHC:0003&amp;culture=en-in&amp;country=in&amp;ali=1 Sign-up for Azure $200 US Credits in 3 months, 12 months free services trial https://azure.microsoft.com/en-us/offers/ms-azr-0044p/ Sign-up for Dynamics 365 for 30 days trial https://trials.dynamics.com Sign-up for Microsoft 365 Developer Program trial https://developer.microsoft.com/en-us/microsoft-365/dev-program Sign-up for Intune, 1-month trial https://go.microsoft.com/fwlink/?linkid=2019088 Other Useful Microsoft Portals Legacy Applications (B2B Redeem Invite) https://account.activedirectory.windowsazure.com/ \u2002\u2022 B2B\u2009 Azure Lighthouse Blade https://portal.azure.com/#blade/Microsoft_Azure_CustomerHub/LighthouseBlade Become Microsoft Certified https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE2PjDI/ \u2002\u2022 aka.ms\u2009 Customer Digital Experiences Previously Demos.Microsoft.com https://cdx.transform.microsoft.com Deployment Guides for Microsoft 365 https://assistants.microsoft.com/ Feedback https://feedbackportal.microsoft.com/ Group Policy Search https://gpsearch.azurewebsites.net/ Infringement Report https://msrc.microsoft.com/report/infringement Fast Cloud File Migrations https://mover.io/ Microsoft Adoption https://adoption.microsoft.com/ Microsoft Assessments https://learn.microsoft.com/en-gb/assessments/ Microsoft Azure Sponsorships https://www.microsoftazuresponsorships.com Microsoft Community https://answers.microsoft.com Microsoft Dynamics Lifecycle Services https://lcs.dynamics.com Microsoft Dynamics 365 and Power Platform Roadmap https://experience.dynamics.com/releaseplans/ Microsoft Exam Sandbox https://mscertdemo.starttest.com/ Microsoft Events https://events.microsoft.com Microsoft Home Use Program https://www.microsoft.com/home-use-program Microsoft MVP https://mvp.microsoft.com Microsoft Open Source https://opensource.microsoft.com Microsoft Remote Connectivity Analyzer https://testconnectivity.microsoft.com \u2002\u2022 aka.ms\u2009 Microsoft Reseller Profile Registration Portal https://reselleruat.microsoftcrmportals.com/ Microsoft Security Response Center https://msrc-blog.microsoft.com/ \u2002\u2022 aka.ms\u2009 Microsoft Startups https://portal.startups.microsoft.com Microsoft 365 Lighthouse https://lighthouse.microsoft.com/ Office 365 Anti-Spam IP Delist Portal https://sender.office.com Outlook Oauth Sandbox https://myadevcenter.outlook.office365.com/ Office UI Fabric Icons https://uifabricicons.azurewebsites.net/ \u2002\u2022 aka.ms\u2009 Power BI Playground https://playground.powerbi.com/ Azure Cosmos DB Query Playground https://www.documentdb.com/sql/demo Service Trust Portal https://servicetrust.microsoft.com Azure Active Directory - Where is your data located? https://msit.powerbi.com/view?r=eyJrIjoiODdjOWViZDctMWRhZS00ODUzLWI4MmQtNWM5NjBkZTBkNjFlIiwidCI6IjcyZjk4OGJmLTg2ZjEtNDFhZi05MWFiLTJkN2NkMDExZGI0NyIsImMiOjV9 Tech Community Video Hub https://techcommunity.microsoft.com/t5/video-hub/ct-p/VideoHub \u2002\u2022 aka.ms\u2009 Windows Virtual Desktop Consent Page https://rdweb.wvd.microsoft.com Microsoft Documentation https://learn.microsoft.com/docs/ Microsoft Training https://learn.microsoft.com/training/ Outlook.com Smart Network Data Service https://sendersupport.olc.protection.outlook.com/snds/index.aspx Azure Pass - Activate Azure subscription using Azure Pass Codes https://www.microsoftazurepass.com/ Azure Updates https://azure.microsoft.com/en-us/updates/ Microsoft Unlocked https://unlocked.microsoft.com/ Get Security Done Dave Caddick https://dcaddick.github.io/gsd_public/ \u2002\u2022 aka.ms\u2009 Windows 365 Subscription URL https://rdweb.wvd.microsoft.com</p>"},{"location":"MSReports/","title":"MSReports","text":""},{"location":"MSReports/#change-default-settings","title":"Change default Settings","text":""},{"location":"MSReports/#increase-retention-time-to-maximum","title":"increase retention time to maximum","text":""},{"location":"Messages-Compliances/","title":"Messages Compliances","text":"Appareils non-conforme : Mises \u00e0 jour Windows<pre><code>Cher utilisateur,\n\nNous tenons \u00e0 vous informer que votre ordinateur ne respecte pas les politiques de s\u00e9curit\u00e9 de notre entreprise. \n\nNous vous demandons donc de prendre les mesures n\u00e9cessaires pour mettre votre ordinateur en conformit\u00e9 avec les politiques de s\u00e9curit\u00e9 ci-dessus:\n\nIl manques les mises \u00e0 jour, veuillez installer les patches windows.\n\nLa s\u00e9curit\u00e9 de nos syst\u00e8mes est une priorit\u00e9 absolue, et nous comptons sur votre coop\u00e9ration pour assurer un environnement informatique s\u00e9curis\u00e9 pour tous.\n\nCordialement,\nL'\u00e9quipe de s\u00e9curit\u00e9 informatique de l'entreprise\n</code></pre> <p>``` title =\"Appareils non-conformes : Antivirus\" Cher utilisateur,</p> <p>Nous tenons \u00e0 vous informer que votre ordinateur ne respecte pas les politiques de s\u00e9curit\u00e9 de notre entreprise. </p> <p>Nous vous demandons donc de prendre les mesures n\u00e9cessaires pour mettre votre ordinateur en conformit\u00e9 avec les politiques de s\u00e9curit\u00e9 ci-dessus:</p> <p>Votre antivirus n'est pas install\u00e9 ou il n'est pas activ\u00e9. Veuillez contacter l'\u00e9quipe de s\u00e9curit\u00e9 informatique</p> <p>La s\u00e9curit\u00e9 de nos syst\u00e8mes est une priorit\u00e9 absolue, et nous comptons sur votre coop\u00e9ration pour assurer un environnement informatique s\u00e9curis\u00e9 pour tous.</p> <p>Cordialement, L'\u00e9quipe de s\u00e9curit\u00e9 informatique de l'entreprise <pre><code>``` title=\"Appareils non-conformes : Chiffrement C:\"\nCher utilisateur,\n\nNous tenons \u00e0 vous informer que votre ordinateur ne respecte pas les politiques de s\u00e9curit\u00e9 de notre entreprise. \n\nNous vous demandons donc de prendre les mesures n\u00e9cessaires pour mettre votre ordinateur en conformit\u00e9 avec les politiques de s\u00e9curit\u00e9 ci-dessus:\n\nVotre disque d\u00fbr (C:) n\u2019est pas chiffr\u00e9\n\nLa s\u00e9curit\u00e9 de nos syst\u00e8mes est une priorit\u00e9 absolue, et nous comptons sur votre coop\u00e9ration pour assurer un environnement informatique s\u00e9curis\u00e9 pour tous.\n\nCordialement,\nL'\u00e9quipe de s\u00e9curit\u00e9 informatique de l'entreprise\n</code></pre></p> Appareils non-conformes : Chiffrement File Vault<pre><code>Cher utilisateur,\n\nNous tenons \u00e0 vous informer que votre ordinateur ne respecte pas les politiques de s\u00e9curit\u00e9 de notre entreprise. \n\nNous vous demandons donc de prendre les mesures n\u00e9cessaires pour mettre votre ordinateur en conformit\u00e9 avec les politiques de s\u00e9curit\u00e9 ci-dessus:\n\nVotre disque d\u00fbr n\u2019est pas chiffr\u00e9, veuillez activer le File-vault de votre Mac\n\nLa s\u00e9curit\u00e9 de nos syst\u00e8mes est une priorit\u00e9 absolue, et nous comptons sur votre coop\u00e9ration pour assurer un environnement informatique s\u00e9curis\u00e9 pour tous.\n\nCordialement,\nL'\u00e9quipe de s\u00e9curit\u00e9 informatique de l'entreprise\n</code></pre> Appareils non-conformes : Pare-Feux d\u00e9sactiv\u00e9<pre><code>Cher utilisateur,\n\nNous tenons \u00e0 vous informer que votre ordinateur ne respecte pas les politiques de s\u00e9curit\u00e9 de notre entreprise. \n\nNous vous demandons donc de prendre les mesures n\u00e9cessaires pour mettre votre ordinateur en conformit\u00e9 avec les politiques de s\u00e9curit\u00e9 ci-dessus:\n\nVotre pare-feux (Firewall) est d\u00e9sactiv\u00e9\n\nLa s\u00e9curit\u00e9 de nos syst\u00e8mes est une priorit\u00e9 absolue, et nous comptons sur votre coop\u00e9ration pour assurer un environnement informatique s\u00e9curis\u00e9 pour tous.\n\nCordialement,\nL'\u00e9quipe de s\u00e9curit\u00e9 informatique de l'entreprise\n</code></pre>"},{"location":"Roomz/","title":"Roomz","text":""},{"location":"Roomz/#customer-using-the-application-permission-with-the-e-mail-security-group","title":"customer using the application permission with the e-Mail security group","text":"<p>Old way (Mail-enabled security group)</p>"},{"location":"SecurityProcesses/","title":"Security Best Practices","text":""},{"location":"SecurityProcesses/#mde-data-location","title":"MDE Data location","text":"<p>Ou se situe les donn\u00e9es at-rest de intune (endpoint.microsoft)?</p> <p>Les donn\u00e9es d'Intune, c'est \u00e0 dire les \u00e9l\u00e9ments de configuration ne sont pas soumis au chiffrement BYOK avec les cl\u00e9 Customer Key, Ref : https://learn.microsoft.com/en-us/microsoft-365/compliance/customer-key-overview?view=o365-worldwide#about-data-encryption-policies</p> <p>Ceci pour la simple raison que ce sont des donn\u00e9es techniques et non pas des donn\u00e9es d'utilisateur.</p> <p>Une grane partie de ces donn\u00e9es 'technique' est heberg\u00e9s dans la r\u00e9gion du tenant, mais cette liste n'est pas disponible et certains service sont r\u00e9pliqu\u00e9s mondialement, comme par exemple (liste non-exhaustive) :  - Les applications publi\u00e9es : elles sont stock\u00e9s sur le CDN de Microsoft, mais chiffr\u00e9es avec une cl\u00e9 unique et donc illisible autrement (c'est pour \u00e7a d'ailleurs que nous ne pouvons pas t\u00e9l\u00e9charger la source d'une app d\u00e9j\u00e0 publi\u00e9e) - Les scripts (powershell et macOS) : ils sont stock\u00e9s sur le CDN de Microsoft, m\u00eame comportement et m\u00eame raison que pour les app ci-dessus Les donn\u00e9es de diagnostique (elles sont dans le tenant Azure li\u00e9 au tenant M365) - Les audits logs de plus de 6 mois (la cible doit etre d\u00e9finit par l'admin du tenant, Microsoft n'a pas la main la dessus)</p> <p>Encore plus de lecture : - https://learn.microsoft.com/en-us/mem/intune/protect/privacy-data-store-process - https://learn.microsoft.com/en-us/microsoft-365/enterprise/o365-data-locations?view=o365-worldwide</p>"},{"location":"SecurityProcesses/#adobe-aip","title":"Adobe AIP","text":"<p>Microsoft Information Protection (MIP) for Acrobat and Acrobat Reader https://helpx.adobe.com/acrobat/kb/mip-plugin-download.html Starting with the June 2022 release (version 22.001.20142 and later) of Acrobat and Acrobat Reader, the MIP plugin is bundled with the installer. It does not require a separate installation.</p>"},{"location":"SharePoint/","title":"Share a user's OneDrive","text":"<p>To allow another user to access a user's OneDrive as an admin (beyond just generating your own access link), you'll need to add them as a Site Collection Administrator on that OneDrive site. There are two effective methods to achieve this:</p>"},{"location":"SharePoint/#quick-video-guide","title":"\ud83c\udfa5 Quick video guide","text":"<p>How to Give Access to OneDrive to Another User in Microsoft\u202f365 Admin Center</p>"},{"location":"SharePoint/#1-use-the-microsoft-365-admin-center","title":"1. Use the Microsoft 365 Admin Center","text":"<ol> <li>Sign in to the Microsoft 365 admin center as a Global or SharePoint Admin.</li> <li>Navigate to Users \u2192 Active users, and select the relevant user.</li> <li>Open the OneDrive tab in their user properties.</li> <li>Click Create link to files \u2013 this will generate access for you to their OneDrive ([learn.microsoft.com][1], [sharepointdiary.com][2]).</li> <li>Use that link to access their OneDrive in your browser.</li> <li>From there, click Return to classic OneDrive, then go to Settings \u2192 Site settings \u2192 Site permissions to assign another user (e.g., a manager or delegate) as a Site Collection Administrator ([learn.microsoft.com][1]).</li> </ol>"},{"location":"SharePoint/#2-via-sharepoint-admin-center","title":"2. Via SharePoint Admin Center","text":"<ol> <li>Go to the SharePoint admin center (via Admin centers \u2192 SharePoint).</li> <li>Click More features \u2192 User Profiles \u2192 Manage User Profiles.  </li> <li>Search for the user's profile. </li> <li>Choose Manage site collection owners, and add the desired user as a Site Collection Admin ([reddit.com][3]).</li> <li>Provide them with the OneDrive URL (e.g. <code>https://&lt;tenant&gt;-my.sharepoint.com/personal/username_domain_com</code>), and they can access it like their own OneDrive ([reddit.com][3]).</li> </ol>"},{"location":"Tricks/","title":"Tips &amp; Tricks","text":""},{"location":"Tricks/#gpos","title":"GPOs","text":""},{"location":"Tricks/#view-applied-policies-with-the-command-prompt","title":"View Applied Policies with the Command Prompt","text":"<p><pre><code>gpresult /r\n</code></pre> User scope<pre><code>gpresult /User xxx /v\n</code></pre> Save results to a file<pre><code>gpresult /R &gt; c:\\RsopReport.txt\n</code></pre> Machine scope (needs to be admin and can be a remote machine)<pre><code>gpresult/r /scope computer\n</code></pre></p> <p>use RSOP.msc to view applied gpo from the domaine controler<pre><code>rsop.msc\n</code></pre> Use GPResult Command to Check Group Policy: Step-by-step Guide (comparitech.com)</p>"},{"location":"Tricks/#windows-licences-activation","title":"Windows Licences Activation","text":"Activate Windows Server 2019<pre><code>cscript c:\\windows\\system32\\slmgr.vbs /ipk &lt;product_key&gt;\n</code></pre> <p>example: <code>cmd cscript c:\\windows\\system32\\slmgr.vbs /ipk XXXXX-XXXXX-XXXXX-XXXXX-XXXXX</code></p> Activate Windows Server 2022<pre><code>Dism /online /Set-Edition:ServerStandard /ProductKey:XXXXX-XXXXX-XXXXX-XXXXX-XXXXX /AcceptEula\n</code></pre>"},{"location":"Tricks/#microsoft-change-product-key-of-office-20162013","title":"Microsoft Change Product Key Of Office 2016/2013","text":"<p>=&gt; look for a file called OSPP.VBS If you\u2019re running 64-bit Office on 64-bit Windows, use the following command:<pre><code>cscript \u201cC:\\Program Files\\Microsoft Office\\Office15\\OSPP.VBS\u201d/inpkey:XXXXX-XXXXX-XXXXX-XXXXX-XXXXX\n</code></pre></p>"},{"location":"Tricks/#upgrade-windows-server-2022-from-evaluation-to-standard","title":"Upgrade Windows server 2022 from Evaluation to Standard","text":"<p>Verify which editions the current installation can be converted to<pre><code>DISM /online /Get-TargetEditions\n</code></pre> Determine the current edition name<pre><code>DISM /online /Get-CurrentEdition\n</code></pre> nter the new edition name and corresponding retail product key<pre><code>DISM /online /Set-Edition:&lt;target edition&gt; /ProductKey:&lt;product key&gt; /AcceptEula\n</code></pre></p>"},{"location":"Tricks/#shortcut-to-run-computer-management","title":"Shortcut to Run Computer management","text":"<pre><code>compmgmt.msc\n</code></pre>"},{"location":"Tricks/#windows-system-ui-languages","title":"Windows System UI Languages","text":"<p>To See System Default UI Language of Windows 10 in PowerShell<pre><code>Get-Culture | Format-List -Property *\n</code></pre> To See System Default UI Language of Windows 10 in Command Prompt (as admin)<pre><code>dism /online /get-intl\n</code></pre></p>"},{"location":"Tricks/#to-see-system-default-and-installed-language-of-windows-10-in-registry-editor","title":"To See System Default and Installed Language of Windows 10 in Registry Editor","text":"<p>In Registry Editor, browse to the key location below. <code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Nls\\Language</code></p> How to See Currently Logged in Users in Windows 10 / 8 / 7<pre><code>query user\n</code></pre> <p>Check installed Windows versions 1<pre><code>systeminfo\n</code></pre> Check installed Windows versions 2<pre><code>winver\n</code></pre> Connaitre l'IP public de sortie d'une machine par command<pre><code>nslookup myip.opendns.com resolver1.opendns.com\n</code></pre> Command to reboot windows computer<pre><code>shutdown /r /t 0\n</code></pre></p>"},{"location":"Tricks/#change-user-password-in-windows-10","title":"Change user password in Windows 10","text":"<p>cmd.exe in administrative mode [Windows-Logo+X]. See all Windows-10 User Accounts.<pre><code>net user\n</code></pre> Then type in the command (in this case for the administrator account):<pre><code>net user administrator *\n</code></pre> And now enter the new Windows 10 password and retype the password to confirm the password. This creates the user account:<pre><code>net user /add [username] [password]\n</code></pre></p> This adds the user to the Local Administrators Group<pre><code>net localgroup administrators [username] /add\n</code></pre>"},{"location":"Tricks/#how-to-force-windows-10-11-to-synchronise-with-a-clock-time-server","title":"How to force Windows 10 &amp; 11 to synchronise with a clock time server?","text":""},{"location":"Tricks/#method-1","title":"Method 1","text":"<p>Press Windows key + r and type services.msc and press enter. Right click on Windows Time and select properties to check the status of the service. Restart the Windows Time service. Click on OK. Restart the computer</p>"},{"location":"Tricks/#method-2","title":"Method 2","text":"<p>Click on clock and select \u201cChange date and time settings\u201d. Click on the \u201cInternet Time\u201d tab. Check if it is set to \u201csynchronize the time with time.windows.com\u201d If the option is selected, click on change settings to check the option \u201cSynchronize with an Internet Time server\u201d Click on OK.</p>"},{"location":"Tricks/#method-3","title":"Method 3","text":"<p>Press Windows key + X and select Command prompt(Admin). Type each one of the command below and press enter. <pre><code>net stop w32time\n</code></pre> <pre><code>w32tm /unregister\n</code></pre> <pre><code>w32tm /register\n</code></pre> <pre><code>net start w32time\n</code></pre> <pre><code>w32tm /resync\n</code></pre> Restart the computer to test the issue again. W32tm.exe is used to configure Windows Time service settings. It can also be used to diagnose problems with the time service. W32tm.exe is the preferred command line tool for configuring, monitoring, or troubleshooting the Windows Time service.</p>"},{"location":"Tricks/#how-to-increase-or-change-trust-relationship-time-limit-on-domain-controller","title":"How to increase or Change trust relationship time limit on domain controller","text":""},{"location":"Tricks/#how-to-check-if-a-windows-registry-key-exists-using-powershell","title":"How to check if a windows registry key exists using powershell?","text":"<p>You can use the <code>Test-Path</code> cmdlet in PowerShell to check if a Windows registry key exists. The syntax is as follows: <pre><code>Test-Path 'Registry::HKEY_LOCAL_MACHINE\\Path\\To\\Key'\n</code></pre> Replace <code>'HKEY_LOCAL_MACHINE\\Path\\To\\Key'</code> with the path to the registry key you want to check. If the key exists, the cmdlet will return <code>True</code>; if it doesn't exist, it will return <code>False</code>.</p>"},{"location":"Tricks/#verify-groups","title":"Verify groups","text":"<pre><code>whoami /groups\n</code></pre>"},{"location":"Tricks/#adding-a-domain-admin","title":"Adding a domain admin","text":"<p>// Create a new user <pre><code>net user mighty Password123! /add /domain\n</code></pre> // Add the new user to Administrator local group <pre><code>net group \"Administrators\" mighty /add /domain\n</code></pre></p>"},{"location":"Tricks/#how-to-prevent-your-users-from-downloading-and-installing-office-via-the-office-portals","title":"How to prevent your users from downloading and installing Office via the Office portals","text":""},{"location":"Tricks/#dc-server-migration","title":"DC Server Migration","text":"<ol> <li>Prepare Existing AD forest for server 2019 DC</li> </ol>"},{"location":"Tricks/#check-fsmo-roles-location","title":"Check FSMO roles location","text":"View FSMO role holders<pre><code>netdom query fsmo\n</code></pre> <p>More explainations</p>"},{"location":"Tricks/#intune-registration-troubleshooting","title":"Intune registration troubleshooting","text":"<p>https://learn.microsoft.com/en-us/samples/azure-samples/dsregtool/dsregtool/</p> <p>Pour les serveurs windows 2012: https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/troubleshoot-security-config-mgt?view=o365-worldwide#instructions-for-applying-computer-join-rule-in-aad-connect</p> <p>Windows server 2012r2 MDE enrollment status: AAD Connect misconfiguration: AAD Connect misconfiguration</p> <p><pre><code>+----------------------------------------------------------------------+\n| Tenant Details                                                       |\n+----------------------------------------------------------------------+\n\n\n+----------------------------------------------------------------------+\n</code></pre> Intune Device Registration troubleshooter Tool - DSRegTool.ps1</p>"},{"location":"Tricks/#an-error-occurred-while-attempting-to-connect-to-server-my-pc-name-check-that-the-virtual-machine-service-is-running-and-that-you-are-authorized-to-connect-to-the-server","title":"\"An error occurred while attempting to connect to server \"MY-PC-NAME\". Check that the Virtual Machine service is running and that you are authorized to connect to the server.","text":"<p>Check if the service </p>"},{"location":"Tricks/#restrict-creation-of-teams","title":"Restrict creation of teams","text":"<p>https://techlabs.blog/categories/office-365/stop-users-from-being-able-to-create-microsoft-teams</p>"},{"location":"Tricks/#office-update-installations","title":"Office update installations","text":"<pre><code>\"C:\\Program Files\\Common Files\\microsoft shared\\ClickToRun\\OfficeC2RClient.exe\" /update user displaylevel=false updatetoversion=16.0.17126.20190\n</code></pre> check with command on line cmd which process or running task<pre><code>tasklist /FI \"IMAGENAME eq OfficeC2RClient.exe\"\n</code></pre>"},{"location":"Tricks/#ms-teams-clearing-cache-in-teams","title":"MS Teams - Clearing Cache in Teams","text":"<p>New location: C:\\Users\\%username%\\AppData\\Local\\Packages\\MSTeams_8wekyb3d8bbwe</p> <p>Classic location: %appdata%\\Microsoft\\Teams</p>"},{"location":"certs/","title":"Uploading SSL certificate to Azure Application gateway","text":"<p>Azure support pfx format for SSL certificates. The certificates that you might have received from your SSL provides will probably be in the .cert format.</p>"},{"location":"certs/#certificate-conversion","title":"Certificate conversion","text":"<p>To convert the certificate, first combine the domain certificate and the intermediate certificate to a single file</p> <p>Your domain cert will look something like this</p> <p><pre><code>-----BEGIN CERTIFICATE-----\nMIIFxTCCBK2gAwIBAgIMKKt3n8G02bLvUx5GMA0GCSqGSIb3DQEBCwUAMEwxCzAJ\nBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWduIG52LXNhMSIwIAYDVQQD...\n....\n....\nPnQbBuHnMqQWOPS1LHZAUf79MWGggNP+g00Y5Aw9jFhVBnv1flren2g=\n-----END CERTIFICATE-----\n</code></pre> Your intermediate certificate will look something like this <pre><code>-----BEGIN CERTIFICATE-----\nMIIETTCCAzWgAwIBAgILBAAAAAABRE7wNjEwDQYJKoZIhvcNAQELBQAwVzELMAkG\nA1UEBhMCQkUxGTAXBgNVBAoTEEdsb2JhbFNpZ24gbnYtc2ExEDAOBgNVBAsT...\n....\n....\nMTh89N1SyvNTBCVXVmaU6Avu5gMUTu79bZRknl7OedSyps9AsUSoPocZXun4IRZZUw==\n-----END CERTIFICATE-----\n</code></pre> Finally when you combine them, the file will look something like this <pre><code>-----BEGIN CERTIFICATE-----\nMIIFxTCCBK2gAwIBAgIMKKt3n8G02bLvUx5GMA0GCSqGSIb3DQEBCwUAMEwxCzAJ\nBgNVBAYTAkJFMRkwFwYDVQQKExBHbG9iYWxTaWduIG52LXNhMSIwIAYDVQQD...\n....\n....\nPnQbBuHnMqQWOPS1LHZAUf79MWGggNP+g00Y5Aw9jFhVBnv1flren2g=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIETTCCAzWgAwIBAgILBAAAAAABRE7wNjEwDQYJKoZIhvcNAQELBQAwVzELMAkG\nA1UEBhMCQkUxGTAXBgNVBAoTEEdsb2JhbFNpZ24gbnYtc2ExEDAOBgNVBAsT...\n....\n....\nMTh89N1SyvNTBCVXVmaU6Avu5gMUTu79bZRknl7OedSyps9AsUSoPocZXun4IRZZUw==\n-----END CERTIFICATE-----\n</code></pre> Save it to a cert+intermediate.cert file</p> <p>Make sure you have your key also ready and let's assume it is named ssl-key.key</p> <p>Now to convert it, use the following command in linux <code>` openssl pkcs12 -export -out certificate.pfx -inkey 'ssl-key.key' -in 'cert+intermediate.cert'</code> This will ask for password <code>Enter Export Password: Verifying - Enter Export Password:</code> Enter a password - make sure to write it down somewhere because this will be required while uploading it to the application gateway.</p> <p>You cannot put a blank password because Application gateway will not allow you to upload an SSL without a password.</p> <p>Once that is done, you'll get a certificate.pfx file.</p> <p>Source: https://blog.mevi.tech/uploading-ssl-certificate-to-azure-application-gateway/</p>"},{"location":"commands/","title":"Standard","text":"<p>Fonction Windows    Commande \u00e0 ex\u00e9cuter</p> <p>Acc\u00e8s bureau \u00e0 distance<pre><code>mstsc\n</code></pre> Acc\u00e9der aux comptes utilisateurs<pre><code>control.exe /name Microsoft.UserAccounts\n</code></pre> Acc\u00e9der aux param\u00e8tres utilisateurs<pre><code>netplwiz\n</code></pre> Acc\u00e9der aux param\u00e8tres utilisateurs avanc\u00e9s<pre><code>azman.msc\n</code></pre> Activation de Windows<pre><code>slui\n</code></pre> Activer ClearType<pre><code>cttune\n</code></pre> Activer la loupe<pre><code>magnify\n</code></pre> Activer ou d\u00e9sactiver des fonctionnalit\u00e9s Windows<pre><code>control appwiz.cpl,,2\n</code></pre> Administrateur OBDC<pre><code>odbcad32\n</code></pre> Affiche l'\u00e9cran de veille - Bulles<pre><code>bubbles.scr\n</code></pre> Affiche l'\u00e9cran de veille - Mystify<pre><code>mystify.scr\n</code></pre> Affiche l'\u00e9cran de veille - Ruban<pre><code>ribbons.scr\n</code></pre> Aide Windows<pre><code>winhlp32\n</code></pre> Ajouter un p\u00e9riph\u00e9rique<pre><code>devicepairingwizard\n</code></pre> Analyse anti logiciel malveillant<pre><code>mrt\n</code></pre> Analyseur de performances<pre><code>perfmon\n</code></pre> Applications par d\u00e9faut<pre><code>control appwiz.cpl,,3\n</code></pre> Assistance \u00e0 distance (Windows remote)<pre><code>msra\n</code></pre> Assistant ajout de mat\u00e9riel<pre><code>hdwwiz\n</code></pre> Assistant cr\u00e9ation d'un dossier partag\u00e9<pre><code>shrpubw\n</code></pre> Assistant de num\u00e9risation (Scanner)<pre><code>wiaacmgr\n</code></pre> Assistant Iexpress<pre><code>iexpress\n</code></pre> C:\\Windows\\debug<pre><code>debug\n</code></pre> Calculatrice<pre><code>calc\n</code></pre> Calibration des couleurs<pre><code>dccw\n</code></pre> Centre de mobilit\u00e9 Windows<pre><code>mblctr\n</code></pre> Centre de synchronisation<pre><code>mobsync\n</code></pre> Centre R\u00e9seau et partage<pre><code>control.exe /name Microsoft.NetworkAndSharingCenter\n</code></pre> Certificats<pre><code>certmgr.msc\n</code></pre> Clavier visuel<pre><code>osk\n</code></pre> Clavier visuel<pre><code>tabtip\n</code></pre> Client Server SQL<pre><code>cliconfg\n</code></pre> Comptes utilisateurs control<pre><code>userpasswords2\n</code></pre> Configuration driver OBDC<pre><code>odbcconf\n</code></pre> Configuration iSCSI<pre><code>iscsicpl\n</code></pre> Configuration syst\u00e8me<pre><code>msconfig\n</code></pre> Connexions r\u00e9seau<pre><code>control netconnections\n</code></pre> Connexions r\u00e9seaux<pre><code>ncpa.cpl\n</code></pre> Contr\u00f4le WMI<pre><code>wmimgmt.msc\n</code></pre> Contr\u00f4leur de jeux<pre><code>joy.cpl\n</code></pre> Cr\u00e9er un disque de r\u00e9paration<pre><code>recdisc\n</code></pre> Cr\u00e9er un lecteur de r\u00e9cup\u00e9ration<pre><code>recoverydrive\n</code></pre> Date et heure<pre><code>timedate.cpl\n</code></pre> Diagnostic DirectX<pre><code>dxdiag\n</code></pre> Dossier Windows Easy Transfer<pre><code>migwiz\n</code></pre> Dossiers des polices<pre><code>fonts\n</code></pre> Dossiers partag\u00e9s<pre><code>fsmgmt.msc\n</code></pre> D\u00e9finir les param\u00e8tres par d\u00e9faut<pre><code>computerdefaults\n</code></pre> D\u00e9fragmenteur de disque<pre><code>dfrgui\n</code></pre> Editeur de caract\u00e8res<pre><code>eudcedit\n</code></pre> Editeur de registre<pre><code>regedit\n</code></pre> Editeur de registre 32 bits<pre><code>regedt32\n</code></pre> Editeur de strat\u00e9gie locale<pre><code>gpedit.msc\n</code></pre> Enregistreur d'actions utilisateurs<pre><code>psr\n</code></pre> Fax (\u00e9diteur de page de garde)<pre><code>fxscover\n</code></pre> Fonctionnalit\u00e9s Windows<pre><code>optionalfeatures\n</code></pre> Gestion de l'ordinateur<pre><code>compmgmt.msc\n</code></pre> Gestion de l'ordinateur<pre><code>compmgmtlauncher\n</code></pre> Gestion de module de plateforme s\u00e9curis\u00e9e<pre><code>tpm.msc\n</code></pre> Gestion des disques<pre><code>diskmgmt.msc\n</code></pre> Gestion des imprimantes<pre><code>printmanagement.msc\n</code></pre> Gestionnaire de p\u00e9riph\u00e9riques<pre><code>devmgmt.msc\n</code></pre> Gestionnaire de p\u00e9riph\u00e9riques<pre><code>hdwwiz.cpl\n</code></pre> Gestionnaire de t\u00e2ches<pre><code>taskmgr\n</code></pre> Gestionnaire du v\u00e9rificateur de pilote<pre><code>verifier\n</code></pre> Gestionnaires de t\u00e2ches<pre><code>launchtm\n</code></pre> G\u00e9rer le mat\u00e9riel du module de plateforme s\u00e9curis\u00e9e (TPM)<pre><code>TpmInit\n</code></pre> Historique des fichiers<pre><code>filehistory\n</code></pre> Importer des contacts dans Windows<pre><code>wabmig\n</code></pre> Informations syst\u00e8me<pre><code>msinfo32\n</code></pre> Installation de pack de langage<pre><code>lpksetup\n</code></pre> Installer un programme \u00e0 partir du r\u00e9seau<pre><code>control appwiz.cpl,,1\n</code></pre> Interface utilisateur de l'imprimante<pre><code>printui\n</code></pre> Internet Explorer<pre><code>iexplore\n</code></pre> Jeu de strat\u00e9gie r\u00e9sultant<pre><code>rsop.msc\n</code></pre> Lecteur Windows Media<pre><code>dvdplay\n</code></pre> Lisibilit\u00e9 de l'\u00e9cran<pre><code>utilman\n</code></pre> Migration d'imprimante<pre><code>printbrmui\n</code></pre> Migration de ccontenus prot\u00e9g\u00e9s<pre><code>dpapimig\n</code></pre> Mixeur de volume<pre><code>sndvol\n</code></pre> Modem et T\u00e9l\u00e9phone<pre><code>telephon.cpl\n</code></pre> Modifier l'affichage sur plusieurs \u00e9crans<pre><code>displayswitch\n</code></pre> Moniteur de ressource<pre><code>resmon\n</code></pre> Moniteur de ressources<pre><code>perfmon /res\n</code></pre> Narrateur<pre><code>narrator\n</code></pre> Nettoyage de disque<pre><code>cleanmgr\n</code></pre> Notepad<pre><code>notepad\n</code></pre> Observateur d'\u00e9v\u00e8nements<pre><code>eventvwr.msc\n</code></pre> Option d'arr\u00eat<pre><code>bootim\n</code></pre> Options d'alimentation<pre><code>powercfg.cpl\n</code></pre> Options d'ergonomie<pre><code>control access.cpl\n</code></pre> Options de l'explorateur de fichiers<pre><code>control folders\n</code></pre> Options de performance<pre><code>systempropertiesperformance\n</code></pre> Options de personnalisation<pre><code>control color\n</code></pre> Options de personnalisation<pre><code>control desktop\n</code></pre> Options Internet<pre><code>inetcpl.cpl\n</code></pre> Outil capture<pre><code>snippingtool\n</code></pre> Outil de calibration<pre><code>tabcal\n</code></pre> Outil de diagnostique Microsoft<pre><code>msdt\n</code></pre> Outils d'administration  control<pre><code>dmintools\n</code></pre> Ouvre l'application mail d\u00e9finie par d\u00e9faut<pre><code>mailto:\n</code></pre> Ouvre l'interface d'arr\u00eat \u00e0 distance<pre><code>shutdown -i\n</code></pre> Ouvre le dossier contacts<pre><code>wab\n</code></pre> Ouvrir l'invite de commande<pre><code>cmd\n</code></pre> Ouvrir l'outil de r\u00e9solution des probl\u00e8mes<pre><code>control.exe /name Microsoft.Troubleshooting\n</code></pre> Ouvrir la corbeille<pre><code>shell:recyclebinfolder\n</code></pre> Ouvrir le dossier documents<pre><code>documents\n</code></pre> Ouvrir le dossier favoris<pre><code>favorites\n</code></pre> Ouvrir le dossier photos<pre><code>pictures\n</code></pre> Ouvrir le dossier vid\u00e9os<pre><code>videos\n</code></pre> Ouvrir les dossier t\u00e9l\u00e9chargements<pre><code>downloads\n</code></pre> Ouvrir les fichiers r\u00e9cents<pre><code>recent\n</code></pre> Ouvrir les param\u00e8tres de barre des t\u00e2ches<pre><code>control.exe /name Microsoft.TaskbarandStartMenu\n</code></pre> Ouvrir Windows CardSpace<pre><code>control.exe /name Microsoft.cardspace\n</code></pre> Ouvrir Windows Sideshow<pre><code>control.exe /name Microsoft.WindowsSideshow\n</code></pre> Paint<pre><code>mspaint\n</code></pre> Paint<pre><code>pbrush\n</code></pre> Panneau de configuration<pre><code>control\n</code></pre> Panneau de saisie pour les math\u00e9matiques<pre><code>mip\n</code></pre> Param\u00e8tres d'affichage<pre><code>dpiscaling\n</code></pre> Param\u00e8tres de contr\u00f4le de compte d'utilisateur (UAC)<pre><code>useraccountcontrolsettings\n</code></pre> Param\u00e8tres de pr\u00e9sentation<pre><code>presentationsettings\n</code></pre> Param\u00e8tres de Windows Script Host<pre><code>wscript\n</code></pre> Param\u00e8tres des couleurs<pre><code>colorcpl\n</code></pre> Pare-feu Windows Defender<pre><code>firewall.cpl\n</code></pre> Personnes \u00e0 proximit\u00e9<pre><code>collab.cpl\n</code></pre> Planificateur de t\u00e2ches<pre><code>taskschd.msc\n</code></pre> Planificateur de t\u00e2ches<pre><code>control schedtasks\n</code></pre> Polices<pre><code>fontview\n</code></pre> Polices<pre><code>control fonts\n</code></pre> Programme d'installation de Windows Update en mode autonome<pre><code>wusa\n</code></pre> Programmes et fonctionnalit\u00e9s<pre><code>appwiz.cpl\n</code></pre> Propri\u00e9t\u00e9 de la souris<pre><code>main.cpl\n</code></pre> Propri\u00e9t\u00e9s de la souris<pre><code>control mouse\n</code></pre> Propri\u00e9t\u00e9s du clavier<pre><code>control keyboard\n</code></pre> Propri\u00e9t\u00e9s protection du syst\u00e8me<pre><code>systempropertiesprotection\n</code></pre> Propri\u00e9t\u00e9s syst\u00e8me<pre><code>sysdm.cpl\n</code></pre> Propri\u00e9t\u00e9s syst\u00e8me avanc\u00e9es<pre><code>systempropertiesadvanced\n</code></pre> Propri\u00e9t\u00e9s syst\u00e8me mat\u00e9riel<pre><code>systempropertieshardware\n</code></pre> Propri\u00e9t\u00e9s syst\u00e8me ordinateur<pre><code>systempropertiescomputername\n</code></pre> Propri\u00e9t\u00e9s syst\u00e8me utilisation \u00e0 distance<pre><code>systempropertiesremote\n</code></pre> Pr\u00e9vention de l'ex\u00e9cution des donn\u00e9es<pre><code>systempropertiesdataexecutionprevention\n</code></pre> P\u00e9riph\u00e9riques et imprimantes<pre><code>control printers\n</code></pre> Register Server (OLE)<pre><code>regsvr32\n</code></pre> Restauration syst\u00e8me<pre><code>rstrui\n</code></pre> R\u00e9gion et Langue<pre><code>intl.cpl\n</code></pre> R\u00e9initialiser Windows<pre><code>systemreset\n</code></pre> R\u00e9solution d'\u00e9cran<pre><code>desk.cpl\n</code></pre> Sauvegarder et restaurer des fichiers Windows<pre><code>sdclt\n</code></pre> Sauvegarder les bases de donn\u00e9es utilisateurs et mots de passe<pre><code>credwiz\n</code></pre> Se connecter \u00e0 un r\u00e9seau distant (ex VPN)<pre><code>rasphone\n</code></pre> Se d\u00e9connecter<pre><code>logoff\n</code></pre> Services<pre><code>services.msc\n</code></pre> Services des composants<pre><code>comexp.msc\n</code></pre> Services des composants<pre><code>dcomcnfg\n</code></pre> Son<pre><code>mmsys.cpl\n</code></pre> Strat\u00e9gie de s\u00e9curit\u00e9 locale<pre><code>secpol.msc\n</code></pre> Stylet et fonction tactile<pre><code>tabletpc.cpl\n</code></pre> Syst\u00e8me de fichier EFS<pre><code>rekeywiz\n</code></pre> S\u00e9curit\u00e9 et maintenance<pre><code>wscui.cpl\n</code></pre> Table des caract\u00e8res<pre><code>charmap\n</code></pre> Testeur WMI<pre><code>wbemtest\n</code></pre> Transfert de fichiers Bluetooth<pre><code>fsquirt\n</code></pre> T\u00e9l\u00e9copie et num\u00e9risation Windows<pre><code>wfs\n</code></pre> T\u00e9l\u00e9phone<pre><code>dialer\n</code></pre> Utilisateurs et goupes locaux<pre><code>lusrmgr.msc\n</code></pre> Version de Windows<pre><code>winver\n</code></pre> V\u00e9rification des signatures de fichiers<pre><code>sigverif\n</code></pre> Windows Disc Image Burning Tool<pre><code>isoburn\n</code></pre> Windows Explorer<pre><code>explorer\n</code></pre> Windows Firewall avec s\u00e9curit\u00e9 avanc\u00e9e<pre><code>wf.msc\n</code></pre> Windows Media Player<pre><code>wmplayer\n</code></pre> Windows PowerShell<pre><code>powershell\n</code></pre> Windows PowerShell ISE<pre><code>powershell_ise\n</code></pre> Windows Update<pre><code>wuapp\n</code></pre> WordPad<pre><code>write\n</code></pre> Wordpad<pre><code>wordpad\n</code></pre> XPS Viewer<pre><code>xpsrchvw\n</code></pre></p>"},{"location":"kql/","title":"Advanced hunting commands - KQL tips","text":"Shows known domain controllers<pre><code>//Show Domain Controllers using localport 88 - type FourToSixMapping\nDeviceNetworkEvents\n| where LocalPort == \"88\"\n| where LocalIPType contains \"FourToSixMapping\"\n| distinct DeviceId\n| join \n    (DeviceInfo\n    | summarize arg_max(Timestamp,*) by DeviceId\n    )\non DeviceId\n| project DeviceId, DeviceName, OnboardingStatus\n</code></pre> <p>Except if your DCs are used as files server, which is of course not recommended at all you should not see many files copied from a workstation or member server to DCs.</p> <p>Using this KQL query you can monitor this activity and identify potential suspect activities or even risky activities:</p> <p>List of files copied from a client to DCs over the last 30 days<pre><code>IdentityDirectoryEvents\n| where ActionType == @\"SMB file copy\"\n| extend ParsedFields=parse_json(AdditionalFields)\n| project Timestamp, ActionType, DeviceName, IPAddress, AccountDisplayName, DestinationDeviceName, DestinationPort, FileName=tostring(ParsedFields.FileName), FilePath=tostring(ParsedFields.FilePath), Method=tostring(ParsedFields.Method)\n| where Method == @\"Write\"\n</code></pre> Even with a password policy in place that affects all user accounts, it is possible to set a blank password for a user with the setting \u201cAccount Password Not Required\u201d using for example a PowerShell cmdlet (not possible through the GUI). This is why it's important to list all users with this setting enabled using the MDI portal but also to track all changes from \u201cAccount Password Not Required\u201d = FALSE to TRUE:</p> \u201cAccount Password Not Required\u201d changed from FALSE to TRUE<pre><code>IdentityDirectoryEvents\n| where ActionType == @\"Account Password Not Required changed\"\n| extend PreviousValue = todynamic(AdditionalFields)[\"FROM Account Password Not Required\"]\n| extend NewValue = todynamic(AdditionalFields)[\"TO Account Password Not Required\"]\n| where \"True\"==NewValue\n| project Timestamp, ActionType, Application, TargetAccountDisplayName, PreviousValue, NewValue\n</code></pre> Detect when a local user account is created on an endpoint<pre><code>//Data connector required for this query - M365 Defender - Device* tables\n\n//Microsoft Sentinel query\nDeviceEvents\n| where TimeGenerated &gt; ago(7d)\n| where ActionType == \"UserAccountCreated\"\n//Exclude defaultuser1 which is created by Windows through different processes \n| where AccountName != \"defaultuser1\"\n| project\n    TimeGenerated,\n    DeviceName,\n    ['Account Created Name']=AccountName,\n    Actor=InitiatingProcessAccountName\n\n//Advanced Hunting query\n\n//Data connector required for this query - Advanced Hunting license\n\nDeviceEvents\n| where Timestamp &gt; ago(7d)\n| where ActionType == \"UserAccountCreated\"\n//Exclude defaultuser1 which is created by Windows through different processes \n| where AccountName != \"defaultuser1\"\n| project\n    Timestamp,\n    DeviceName,\n    ['Account Created Name']=AccountName,\n    Actor=InitiatingProcessAccountName\n</code></pre> <p>The account lockout policy is a built-in security measure that limits malicious users and hackers from illegitimately accessing your network resources. However, employees often use multiple devices, numerous productivity applications, Windows services, tasks, network mapping and more, which can store a wrong password and set off the account lockout. It could be interesting to identify machines or IPs from where Account Lockout threshold is triggered only based on MDI raw data. Remark: DeviceName and IPAdress can sometime be empty (no raw data).</p> Identify machines or IPs from where Account Lockout threshold is triggered<pre><code>IdentityLogonEvents\n| where Application == @\"Active Directory\" // AD only\n| where AccountDomain == @\"msdemo.org\" // if needed to filter by domain\n| where ActionType == @\"LogonFailed\"\n| where FailureReason == @\"WrongPassword\" or FailureReason == @\"AccountLocked\" //badpasswordcount attribute\n| summarize FailureReason = count() by DeviceName, IPAddress, AccountUpn\n| where FailureReason &gt; 15 //depending on the Account Lockout threshold\n</code></pre> <p>See: https://learn.microsoft.com/en-us/microsoft-365/security/defender/custom-detection-rules?view=o365-worldwide</p>"},{"location":"linux/","title":"To install sudo on Debian, follow these steps:","text":""},{"location":"linux/#install-the-sudo-command","title":"Install the 'sudo' Command:","text":"<p>Log in as root and update the system package list using apt update. Install sudo by running apt install sudo or combine both commands with </p> <pre><code>apt update &amp;&amp; apt install sudo\n</code></pre>"},{"location":"linux/#add-a-regular-user-to-the-sudo-group","title":"Add a Regular User to the sudo Group:","text":"<p>Add a user to the sudo group by editing \"sudoers\" <pre><code>nano /etc/sudoers\n</code></pre></p>"},{"location":"linux/#user-privilege-specification","title":"User privilege specification","text":"<p>root    ALL=(ALL:ALL) ALL jip     ALL=(ALL:ALL) ALL</p>"},{"location":"powershell/","title":"Connect on Exchange On-line (Mac)","text":"install powershell on a mac<pre><code>brew install powershell\nbrew install openssl\npwsh\nInstall-Module -Name PowerShellGet\nInstall-Module -Name PSWSMan\nsudo pwsh -Command 'Install-WSMan'\n</code></pre> <p>connect with a mac with an interactive logon<pre><code>$ExchangeSession = Connect-ExchangeOnline\n</code></pre> Change calendar time zone<pre><code>Set-MailboxCalendarConfiguration -Identity peter@contoso.com -WorkingHoursTimeZone \"Pacific Standard Time\"\n</code></pre></p>"},{"location":"powershell/#connect-on-microsoft-graph-with-powershell","title":"Connect on Microsoft Graph with powershell","text":"<p>Install the module<pre><code>Install-Module Microsoft.Graph -Scope AllUsers   \nConnect-MgGraph -TenantId \"yourTenant GUID\"\n</code></pre> Connect<pre><code>Install-Module Microsoft.Graph -Scope AllUsers   \nConnect-MgGraph -TenantId \"yourTenant GUID\"\n</code></pre></p>"},{"location":"powershell/#test-viruses-and-antiviruses","title":"Test Viruses and Antiviruses","text":"Mimikatz<pre><code>invoke-mimikatz\n</code></pre>"},{"location":"powershell/#check-installed-application","title":"Check Installed application","text":"Powershell Check installed applications<pre><code>wmic product get name,vendor,IdentifyingNumber,Version,InstallDate\n</code></pre>"},{"location":"powershell/#check-running-services","title":"Check running services","text":"powershell check running services<pre><code>wmic service get Caption,StartName,StartMode\n</code></pre>"},{"location":"powershell/#check-installed-drivers","title":"check installed drivers","text":"Check installed drivers<pre><code>driverquery /v\n</code></pre>"},{"location":"powershell/#check-routes","title":"check routes","text":"Check routes<pre><code>route print\n</code></pre>"},{"location":"powershell/#check-tasks","title":"check tasks","text":"Check computer tasks<pre><code>tasklist\n</code></pre>"},{"location":"powershell/#check-boot-time","title":"Check Boot time","text":"Check Boot time<pre><code>systeminfo | find \"System Boot Time:\"\n</code></pre>"},{"location":"powershell/#autres","title":"Autres","text":"How to get date of last Windows update install or at least checked for an update?<pre><code>gwmi win32_quickfixengineering |sort installedon -desc \n</code></pre>"}]}